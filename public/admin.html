<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boshqaruv Paneli</title>
    
    <link href="https://cdn.webdatarocks.com/latest/webdatarocks.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="admin.css?v=2024112405">
    <link rel="stylesheet" href="branding.css">
    <link rel="stylesheet" href="loader.css">
    <link rel="stylesheet" href="month-selector.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Foydalanuvchi tablari uchun stillar */
        .user-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color );
        }
        .user-tabs button {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: color 0.3s, border-color 0.3s;
        }
        .user-tabs button:hover {
            color: var(--text-primary);
        }
        .user-tabs button.active {
            color: var(--blue-color);
            border-bottom-color: var(--blue-color);
        }
        .user-list-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .status-badge {
            font-size: 11px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 12px;
            margin-left: 8px;
            vertical-align: middle;
        }
        .status-badge.blocked {
            background-color: rgba(220, 53, 69, 0.2);
            color: var(--red-color);
        }
        .status-badge.archived {
            background-color: rgba(108, 117, 125, 0.2);
            color: #adb5bd;
        }
        .status-badge.pending {
            background-color: rgba(255, 193, 7, 0.2);
            color: var(--yellow-color);
        }

        /* Xodimlar statistikasi uchun maxsus stillar */
        .kpi-table th {
            cursor: pointer;
            position: relative;
            user-select: none;
        }
        .kpi-table th .sort-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.5;
            transition: opacity 0.2s;
        }
        .kpi-table th.sorted .sort-icon {
            opacity: 1;
        }
        .kpi-progress-bar {
            width: 100%;
            height: 20px;
            background-color: var(--header-bg);
            border-radius: 4px;
            overflow: hidden;
            display: flex;
        }
        .kpi-progress-bar .bar-segment {
            height: 100%;
            transition: width 0.5s;
        }
        .kpi-progress-bar .on-time { background-color: var(--green-color); }
        .kpi-progress-bar .late { background-color: var(--yellow-color); }

        .employee-details-view {
            margin-top: 30px;
            display: none; /* Boshida yashirin */
        }
        .details-calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 20px;
        }
        .calendar-day {
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            min-height: 60px;
            border: 1px solid var(--border-color);
            position: relative;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .calendar-day:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .calendar-day .day-number { font-weight: 600; font-size: 18px; }
        .calendar-day.on_time { background-color: rgba(40, 167, 69, 0.2); border-color: var(--green-color); }
        .calendar-day.late { background-color: rgba(255, 193, 7, 0.2); border-color: var(--yellow-color); }
        .calendar-day.not_submitted { background-color: rgba(220, 53, 69, 0.15); border-color: var(--red-color); opacity: 0.7; }
        .calendar-day.disabled { background-color: var(--header-bg); opacity: 0.5; cursor: default; }
        .calendar-day .edit-indicator {
            position: absolute;
            top: 5px;
            right: 5px;
            color: var(--cyan-color);
        }
        .calendar-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            text-align: center;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
    </style>
</head>
<body class="admin-page">

    <!-- Global Page Loader -->
    <div id="page-loader" class="page-loader">
        <div id="loader-animation"></div>
        <div id="loader-text" class="loader-text">Yuklanmoqda...</div>
        <div id="loader-progress" class="loader-progress-bar"></div>
    </div>

    <div class="admin-layout">
        <!-- 1. YON PANEL (SIDEBAR ) -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-border-effect">
                    <a href="/" class="brand-logo">MANUS</a>
                </div>
            </div>
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-link active" data-page="dashboard" data-permission="dashboard:view">
                    <i data-feather="home"></i>
                    <span>Bosh Sahifa</span>
                </a>
                <!-- YANGI MENYU BANDI -->
                <a href="#employee-statistics" class="nav-link" data-page="employee-statistics" data-permission="dashboard:view">
                    <i data-feather="trending-up"></i>
                    <span>Xodimlar Statistikasi</span>
                </a>
                <a href="#pivot-reports" class="nav-link" data-page="pivot-reports" data-permission="reports:view_all">
                    <i data-feather="bar-chart-2"></i>
                    <span>Interaktiv hisobotlar</span>
                </a>
                <a href="#comparison" class="nav-link" data-page="comparison" data-permission="comparison:view">
                    <i data-feather="shuffle"></i>
                    <span>Qiymatlarni Solishtirish</span>
                </a>
                <a href="#requests" class="nav-link" data-page="requests" data-permission="users:edit">
                    <i data-feather="user-check"></i>
                    <span>So'rovlar</span>
                    <span id="requests-count-badge" class="badge-count hidden">0</span>
                </a>
                <a href="#users" class="nav-link" data-page="users" data-permission="users:view">
                    <i data-feather="users"></i>
                    <span>Foydalanuvchilar</span>
                </a>
                <a href="#security" class="nav-link" data-page="security">
                    <i data-feather="shield"></i>
                    <span>Xavfsizlik</span>
                </a>
                <a href="#roles" class="nav-link" data-page="roles" data-permission="roles:manage">
                    <i data-feather="sliders"></i>
                    <span>Rollar va Huquqlar</span>
                </a>
                <a href="#audit-log" class="nav-link" data-page="audit-log" data-permission="audit:view">
                    <i data-feather="database"></i>
                    <span>Tizim Jurnali</span>
                </a>
                <a href="#settings" class="nav-link" data-page="settings" data-permission="settings:view">
                    <i data-feather="settings"></i>
                    <span>Sozlamalar</span>
                </a>
                <a href="#admin-controls" class="nav-link" data-page="admin-controls" data-permission="roles:manage">
                    <i data-feather="tool"></i>
                    <span>Admin Boshqaruvi</span>
                </a>
                <a href="#branding" class="nav-link" data-page="branding" data-permission="settings:edit_general">
                    <i data-feather="pen-tool"></i>
                    <span>Brending</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="/" class="back-to-main-btn">
                    <i data-feather="arrow-left-circle"></i>
                    <span>Asosiy Sahifaga</span>
                </a>
                <button id="logout-btn" class="btn btn-danger sidebar-logout-btn" style="width: 100%; margin-top: 10px; box-sizing: border-box;">
                    <i data-feather="log-out"></i>
                    <span>Chiqish</span>
                </button>
            </div>
        </aside>

        <!-- 2. ASOSIY KONTENT -->
        <main class="main-content">
            <!-- Bosh Sahifa (Dashboard) -->
            <section id="dashboard" class="page" data-permission="dashboard:view">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">Boshqaruv Paneli</h1>
                        <p class="page-description">Tizimning <strong id="dashboard-selected-date">bugungi</strong> umumiy holati va statistik ma'lumotlar.</p>
                    </div>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <input type="text" id="dashboard-date-picker" class="form-control" style="width: 250px;" placeholder="Sanani tanlang">
                        <button id="customize-stats-btn" class="btn btn-secondary" title="Statistikalarni sozlash">
                            <i data-feather="sliders"></i> Sozlash
                        </button>
                    </div>
                </div>
                
                <!-- Statistikalar sozlash modali -->
                <div id="stats-config-modal" class="modal hidden">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h2 class="modal-title">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M1 11a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3zm5-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V2z"/>
                                    </svg>
                                    Statistikalarni Sozlash
                                </h2>
                                <button class="btn-close close-modal"></button>
                            </div>
                            <div class="modal-body">
                                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                                    Ko'rsatmoqchi bo'lgan statistikalarni tanlang (maksimal 6 ta):
                                </p>
                                <div class="stats-options-grid" id="stats-options-grid">
                                    <!-- JavaScript orqali to'ldiriladi -->
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-secondary close-modal">Bekor qilish</button>
                                <button id="save-stats-config-btn" class="btn btn-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                                    </svg>
                                    Saqlash
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid" id="stats-grid"></div>
                
                <!-- Grafiklar bo'limi -->
                <div class="card" style="margin-top: 30px;">
                    <div class="card-header-with-actions">
                        <h3 class="card-title" id="chart-title">Haftalik Dinamika (Hisobotlar Soni)</h3>
                        <button id="customize-charts-btn" class="btn btn-secondary btn-sm" title="Grafiklarni sozlash">
                            <i data-feather="bar-chart-2"></i> Grafikni O'zgartirish
                        </button>
                    </div>
                    <div id="charts-container" class="charts-grid">
                        <div id="chart-1" class="chart-wrapper" style="height: 300px; position: relative;">
                            <canvas id="weekly-dynamics-chart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Grafik fullscreen modali -->
                <div id="chart-fullscreen-modal" class="modal hidden">
                    <div class="modal-dialog modal-xl modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h2 class="modal-title" id="fullscreen-chart-title">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M4 11H2v3h3v-2H4v-1zm0-5H2V3h3v2H4v1zm8 5v1h1v2h-3v-3h2zm0-5V5h1V3h-3v3h2z"/>
                                    </svg>
                                    <span>Grafik</span>
                                </h2>
                                <button class="btn-close" id="close-chart-fullscreen"></button>
                            </div>
                            <div class="modal-body" style="padding: 30px;">
                                <div id="fullscreen-chart-container" style="height: 500px; position: relative;">
                                    <canvas id="fullscreen-chart-canvas"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Grafiklarni sozlash modali -->
                <div id="charts-config-modal" class="modal hidden">
                    <div class="modal-dialog modal-dialog-centered" style="max-width: 700px;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h2 class="modal-title">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M0 0h1v15h15v1H0V0Zm14.817 3.113a.5.5 0 0 1 .07.704l-4.5 5.5a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61 4.15-5.073a.5.5 0 0 1 .704-.07Z"/>
                                    </svg>
                                    Grafiklarni Sozlash
                                </h2>
                                <button class="btn-close close-modal"></button>
                            </div>
                            <div class="modal-body">
                                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                                    Ko'rsatmoqchi bo'lgan grafiklarni tanlang (maksimal 3 ta):
                                </p>
                                <div class="charts-options-grid" id="charts-options-grid">
                                    <!-- JavaScript orqali to'ldiriladi -->
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-secondary close-modal">Bekor qilish</button>
                                <button id="save-charts-config-btn" class="btn btn-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                                    </svg>
                                    Saqlash
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Filiallar bo'yicha holat -->
                <div class="card" style="margin-top: 30px;">
                    <div class="locations-header">
                        <div>
                            <h3 class="card-title">Filiallar Bo'yicha Holat</h3>
                            <div class="locations-summary" id="locations-summary">
                                <!-- JavaScript orqali to'ldiriladi -->
                            </div>
                        </div>
                        <div class="locations-controls">
                            <div class="form-group" style="min-width: 250px; margin-bottom: 0;">
                                <select id="location-filter" class="form-control">
                                    <option value="all">Barcha filiallar</option>
                                </select>
                            </div>
                            <div class="filter-buttons" id="location-filters">
                                <button class="filter-btn active" data-filter="all">
                                    <i class="fas fa-th"></i> Hammasi
                                </button>
                                <button class="filter-btn" data-filter="submitted">
                                    <i class="fas fa-check-circle"></i> Topshirilgan
                                </button>
                                <button class="filter-btn" data-filter="not-submitted">
                                    <i class="fas fa-times-circle"></i> Topshirilmagan
                                </button>
                                <button class="filter-btn" data-filter="edited">
                                    <i class="fas fa-edit"></i> Tahrirlangan
                                </button>
                            </div>
                            <div class="view-toggle">
                                <button class="view-btn active" data-view="grid" title="Grid ko'rinish">
                                    <i class="fas fa-th"></i>
                                </button>
                                <button class="view-btn" data-view="list" title="Ro'yxat ko'rinish">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="daily-status-grid" id="daily-status-grid"></div>
                </div>
            </section>

            <!-- Xodimlar Statistikasi (KPI) -->
            <section id="employee-statistics" class="page" data-permission="dashboard:view">
                <div class="page-header">
                    <h1 class="page-title">Xodimlar Ish Samaradorligi (KPI)</h1>
                    <div class="modern-month-selector">
                        <button class="month-nav-btn" id="prev-month-btn">
                            <i data-feather="chevron-left"></i>
                        </button>
                        <div class="month-display" id="month-display-btn">
                            <span id="current-month-text">Noyabr 2025</span>
                            <i data-feather="calendar" style="width: 18px; height: 18px; margin-left: 8px;"></i>
                        </div>
                        <button class="month-nav-btn" id="next-month-btn">
                            <i data-feather="chevron-right"></i>
                        </button>
                    </div>
                    <div class="month-dropdown hidden" id="month-dropdown">
                        <div class="month-dropdown-header">
                            <button class="year-nav-btn" id="prev-year-btn">
                                <i data-feather="chevron-left"></i>
                            </button>
                            <span class="current-year" id="dropdown-year">2025</span>
                            <button class="year-nav-btn" id="next-year-btn">
                                <i data-feather="chevron-right"></i>
                            </button>
                        </div>
                        <div class="months-grid" id="months-grid"></div>
                    </div>
                </div>
                
                <!-- Statistika Kartalari -->
                <div id="kpi-stats-cards" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 30px;"></div>

                <!-- Jadval -->
                <div class="card">
                    <h3 class="card-title">Xodimlar Reytingi</h3>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Xodim</th>
                                    <th>Filiallar</th>
                                    <th>KPI Ball</th>
                                    <th>Topshirilgan</th>
                                    <th>O'z vaqtida</th>
                                    <th>Kechikkan</th>
                                    <th>Tahrirlangan</th>
                                </tr>
                            </thead>
                            <tbody id="kpi-table-body">
                                <tr>
                                    <td colspan="8">Yuklanmoqda...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Kalendar Modal -->
            <div id="kpi-calendar-modal" class="modal hidden" style="z-index: 1000;">
                <div class="modal-content" style="max-width: 900px; width: 90%;">
                    <button class="close-modal-btn" id="close-calendar-modal">
                        <i data-feather="x"></i>
                    </button>
                    <div class="modal-header" style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <div style="width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 20px;" id="calendar-avatar"></div>
                        <div>
                            <h3 class="modal-title" id="calendar-employee-name" style="margin: 0; font-size: 22px;"></h3>
                            <p style="margin: 5px 0 0 0; opacity: 0.7; font-size: 14px;" id="calendar-month-label"></p>
                        </div>
                    </div>
                    
                    <!-- Kalendar Statistika -->
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 25px;" id="calendar-stats"></div>
                    
                    <!-- Kalendar Grid -->
                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin-bottom: 15px;">
                        <div style="text-align: center; font-weight: 600; padding: 10px; background: rgba(79, 172, 254, 0.1); border-radius: 8px; color: #4facfe;">Yak</div>
                        <div style="text-align: center; font-weight: 600; padding: 10px; background: rgba(79, 172, 254, 0.1); border-radius: 8px; color: #4facfe;">Du</div>
                        <div style="text-align: center; font-weight: 600; padding: 10px; background: rgba(79, 172, 254, 0.1); border-radius: 8px; color: #4facfe;">Se</div>
                        <div style="text-align: center; font-weight: 600; padding: 10px; background: rgba(79, 172, 254, 0.1); border-radius: 8px; color: #4facfe;">Cho</div>
                        <div style="text-align: center; font-weight: 600; padding: 10px; background: rgba(79, 172, 254, 0.1); border-radius: 8px; color: #4facfe;">Pay</div>
                        <div style="text-align: center; font-weight: 600; padding: 10px; background: rgba(79, 172, 254, 0.1); border-radius: 8px; color: #4facfe;">Ju</div>
                        <div style="text-align: center; font-weight: 600; padding: 10px; background: rgba(79, 172, 254, 0.1); border-radius: 8px; color: #4facfe;">Sha</div>
                    </div>
                    <div id="modal-calendar-grid" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px;"></div>
                </div>
            </div>
            
            <!-- Kun Batafsil Modal -->
            <div id="day-details-modal" class="modal hidden" style="z-index: 1100;">
                <div class="modal-content" style="max-width: 600px;">
                    <button class="close-modal-btn" id="close-day-details-modal">
                        <i data-feather="x"></i>
                    </button>
                    <h3 class="modal-title" id="day-details-title" style="margin-bottom: 20px;"></h3>
                    
                    <div id="day-details-content" style="display: flex; flex-direction: column; gap: 15px;">
                        <!-- Bu yerda kun ma'lumotlari ko'rsatiladi -->
                    </div>
                </div>
            </div>

            <!-- Brend Modal -->
            <div id="brand-modal" class="modal hidden" style="z-index: 1100;">
                <div class="modal-content" style="max-width: 500px;">
                    <button class="close-modal-btn" id="close-brand-modal">
                        <i data-feather="x"></i>
                    </button>
                    <h3 class="modal-title" id="brand-modal-title">Yangi Brend</h3>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px;">
                        <div class="form-group">
                            <label for="brand-name-input">Brend nomi *</label>
                            <input type="text" id="brand-name-input" class="form-control" placeholder="Masalan: Coca-Cola">
                        </div>
                        
                        <div class="form-group">
                            <label for="brand-color-input">Rang</label>
                            <input type="color" id="brand-color-input" class="form-control" value="#4facfe" style="height: 60px; padding: 2px; cursor: pointer; width: 100%; border-radius: 8px;">
                        </div>
                        
                        <div class="form-group">
                            <label>Filiallar</label>
                            <p style="color: rgba(255,255,255,0.6); font-size: 13px; margin-bottom: 10px;">
                                Brendni qaysi filiallarga biriktirmoqchisiz? (Bir nechta tanlash mumkin)
                            </p>
                            <div id="brand-locations-list" style="max-height: 200px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 10px; background: rgba(0,0,0,0.2);">
                                <!-- Filiallar checkbox ro'yxati -->
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 10px;">
                            <button class="btn btn-secondary" id="cancel-brand-btn">Bekor qilish</button>
                            <button class="btn btn-primary" id="save-brand-btn"><i data-feather="save"></i> Saqlash</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ustun Modal -->
            <div id="column-modal" class="modal hidden" style="z-index: 1100;">
                <div class="modal-content" style="max-width: 400px;">
                    <button class="close-modal-btn" id="close-column-modal">
                        <i data-feather="x"></i>
                    </button>
                    <h3 class="modal-title" id="column-modal-title">Yangi Ustun</h3>
                    
                    <div style="margin-top: 20px;">
                        <div class="form-group">
                            <label for="column-name-input">Ustun nomi *</label>
                            <input type="text" id="column-name-input" class="form-control" placeholder="Masalan: Savdo hajmi" autofocus>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                            <button class="btn btn-secondary" id="cancel-column-btn">Bekor qilish</button>
                            <button class="btn btn-primary" id="save-column-btn"><i data-feather="save"></i> Saqlash</button>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Filial Modal -->
            <div id="location-modal" class="modal hidden" style="z-index: 1100;">
                <div class="modal-content" style="max-width: 400px;">
                    <button class="close-modal-btn" id="close-location-modal">
                        <i data-feather="x"></i>
                    </button>
                    <h3 class="modal-title" id="location-modal-title">Yangi Filial</h3>
                    
                    <div style="margin-top: 20px;">
                        <div class="form-group">
                            <label for="location-name-input">Filial nomi *</label>
                            <input type="text" id="location-name-input" class="form-control" placeholder="Masalan: Toshkent" autofocus>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                            <button class="btn btn-secondary" id="cancel-location-btn">Bekor qilish</button>
                            <button class="btn btn-primary" id="save-location-btn"><i data-feather="save"></i> Saqlash</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Batafsil kalendar (eski) -->
            <div id="employee-details-view" style="display: none;">
                    <div class="card">
                        <div class="page-header">
                            <h3 class="card-title" id="details-view-title"></h3>
                            <button id="back-to-list-btn" class="btn btn-secondary">
                                <i data-feather="arrow-left"></i> Ortga
                            </button>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-bottom: 10px; text-align: center; font-weight: 600;">
                            <div>Yak</div><div>Du</div><div>Se</div><div>Cho</div><div>Pay</div><div>Ju</div><div>Sha</div>
                        </div>
                        <div id="calendar-grid" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px;"></div>
                    </div>
                </div>
            </section>

            <!-- Interaktiv hisobotlar (Pivot) -->
            <section id="pivot-reports" class="page" data-permission="reports:view_all">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">Interaktiv hisobotlar</h1>
                        <p class="page-description">
                            Bu bo'limda barcha hisobotlarni qulay shaklda tahlil qilish, filtrdan o'tkazish va pivot jadvallar ko'rinishida ko'rishingiz mumkin.
                        </p>
                    </div>
                    <div style="display: flex; gap: 15px; align-items: flex-end;">
                    <div class="form-group" style="min-width: 300px;">
                        <label for="pivot-date-filter">Hisobotlar davri</label>
                        <input type="text" id="pivot-date-filter" class="form-control" placeholder="Sana oralig'ini tanlang...">
                        </div>
                        <div class="form-group" style="min-width: 200px;">
                            <label for="pivot-currency-select">Ko'rish valyutasi</label>
                            <select id="pivot-currency-select" class="form-control">
                                <option value="UZS">UZS (So'm)</option>
                                <option value="USD">USD ($)</option>
                                <option value="EUR">EUR (‚Ç¨)</option>
                                <option value="RUB">RUB (‚ÇΩ)</option>
                                <option value="KZT">KZT (‚Ç∏)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Kurslar ko'rsatish bo'limi -->
                <div id="pivot-exchange-rates" class="card exchange-rates-container" style="margin-bottom: 20px; display: none;">
                    <div class="card-header exchange-rates-header">
                        <div class="exchange-rates-title-wrapper">
                            <div class="exchange-rates-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div>
                                <h3 class="card-title exchange-rates-title">Valyuta kurslari</h3>
                                <p class="exchange-rates-subtitle">Hozirgi holatdagi valyuta kurslari</p>
                            </div>
                        </div>
                        <div class="exchange-rates-controls">
                            <div class="exchange-rates-status">
                                <span class="status-dot"></span>
                                <span id="rates-last-updated" class="rates-updated-text">Yuklanmoqda...</span>
                            </div>
                            <button id="refresh-rates-btn" class="btn-refresh-rates" title="Kurslarni yangilash">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body exchange-rates-body">
                        <div id="exchange-rates-list" class="exchange-rates-grid">
                            <!-- Kurslar bu yerda ko'rsatiladi -->
                        </div>
                    </div>
                </div>
                
                <!-- Saqlangan shablonlar - doimo ochiq -->
                <div id="templates-panel" class="card templates-panel" style="margin-bottom: 20px;">
                    <div class="templates-panel-header">
                        <h3 class="card-title">Saqlangan shablonlar</h3>
                    </div>
                    <div id="templates-tag-list" class="templates-tag-list"></div>
                </div>
                
                <div id="pivot-container"></div>
            </section>

            <!-- Qiymatlarni Solishtirish -->
            <section id="comparison" class="page" data-permission="comparison:view">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">Qiymatlarni Solishtirish</h1>
                        <p class="page-description">
                            Filiallar bo'yicha operatorlar kiritgan summalarni solishtirish summasi bilan taqqoslash. Har bir filial uchun operator summa avtomatik hisoblanadi, solishtirish summa qo'lda kiritiladi.
                        </p>
                    </div>
                    <div style="display: flex; gap: 15px; align-items: flex-end; flex-wrap: wrap;">
                        <div class="form-group" style="min-width: 200px;">
                            <label for="comparison-date-filter">Solishtirish Sanasi</label>
                            <input type="date" id="comparison-date-filter" class="form-control" required>
                        </div>
                        <div class="form-group" style="min-width: 250px;">
                            <label for="comparison-brand-select">Solishtirish Brendi (faqat bitta tanlash mumkin)</label>
                            <select id="comparison-brand-select" class="form-control" required>
                                <option value="">Brendni tanlang...</option>
                            </select>
                        </div>
                        <div class="form-group" style="min-width: 150px;">
                            <button id="comparison-load-btn" class="btn btn-primary" style="height: 38px;">
                                <i data-feather="search"></i>
                                <span>Qidirish</span>
                            </button>
                        </div>
                    </div>
                    <div id="comparison-selected-brand" style="margin-top: 15px; padding: 10px; background: linear-gradient(135deg, rgba(40, 167, 69, 0.1), rgba(25, 135, 84, 0.05)); border-radius: 8px; display: none;">
                        <strong>Tanlangan Brend:</strong> <span id="comparison-brand-name">-</span>
                    </div>
                </div>

                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                        <h3 class="card-title">Solishtirish Jadvali</h3>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button id="comparison-save-btn" class="btn btn-success" data-permission="comparison:edit" style="display: none;">
                                <i data-feather="save"></i>
                                <span>Saqlash</span>
                            </button>
                            <button id="comparison-import-btn" class="btn btn-warning" data-permission="comparison:edit" style="display: none;">
                                <i data-feather="upload"></i>
                                <span>Excel Import</span>
                            </button>
                            <input type="file" id="comparison-import-file" accept=".xlsx,.xls" style="display: none;">
                            <button id="comparison-template-btn" class="btn btn-secondary" data-permission="comparison:view" style="display: none;">
                                <i data-feather="file-text"></i>
                                <span>Shablon Yuklab Olish</span>
                            </button>
                            <button id="comparison-export-btn" class="btn btn-info" data-permission="comparison:export" style="display: none;">
                                <i data-feather="download"></i>
                                <span>Excel Export</span>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="comparison-table-container">
                            <div id="comparison-empty-state">
                                <i data-feather="search"></i>
                                <p>Sana va brendni tanlab, "Qidirish" tugmasini bosing</p>
                            </div>
                            <div class="comparison-table-wrapper" style="display: none;">
                                <table id="comparison-table">
                                    <thead>
                                        <tr>
                                            <th>FILIALLAR</th>
                                            <th>Operator kiritgan summalar</th>
                                            <th>Solishtirish summasi (qo'lda kiritiladi)</th>
                                            <th>Farq</th>
                                            <th>Foiz (%)</th>
                                            <th>Holat</th>
                                        </tr>
                                    </thead>
                                    <tbody id="comparison-table-body">
                                        <!-- Ma'lumotlar bu yerda -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Modal: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω -->
            <div id="save-template-modal" class="modal hidden">
                <div class="modal-content modal-small">
                    <div class="modal-header">
                        <h3 class="modal-title">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω</h3>
                        <button class="modal-close" onclick="document.getElementById('save-template-modal').classList.add('hidden')">
                            <i data-feather="x"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">
                            –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
                        </p>
                        <div class="form-group">
                            <label for="template-name-input">–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞</label>
                            <input 
                                type="text" 
                                id="template-name-input" 
                                class="form-control" 
                                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –±—Ä–µ–Ω–¥–∞–º"
                                maxlength="100">
                        </div>
                        <div class="form-group" id="public-template-option" style="display: none;">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="template-is-public-checkbox" style="width: 18px; height: 18px; cursor: pointer;">
                                <span style="color: var(--text-primary); font-size: 14px;">
                                    <i class="fas fa-globe" style="color: #10b981; margin-right: 5px;"></i>
                                    –ü—É–±–ª–∏—á–Ω—ã–π —à–∞–±–ª–æ–Ω (–¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º)
                                </span>
                            </label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="document.getElementById('save-template-modal').classList.add('hidden')">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                        <button id="confirm-save-template-btn" class="btn btn-success">
                            <i data-feather="save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>

            <!-- Modal: –ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω -->
            <div id="load-template-modal" class="modal hidden">
                <div class="modal-content modal-medium">
                    <div class="modal-header">
                        <h3 class="modal-title">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω</h3>
                        <button class="modal-close" onclick="document.getElementById('load-template-modal').classList.add('hidden')">
                            <i data-feather="x"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
                        </p>
                        <div id="templates-list-container" class="templates-list-container">
                            <!-- –°–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="document.getElementById('load-template-modal').classList.add('hidden')">
                            –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Registratsiya so'rovlari (MODERNIZED) -->
            <section id="requests" class="page" data-permission="users:edit">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">
                            <i data-feather="user-plus"></i>
                            Yangi Foydalanuvchi So'rovlari
                        </h1>
                        <p class="page-description">
                            Ro'yxatdan o'tish uchun yuborilgan so'rovlarni tasdiqlash yoki rad etish
                        </p>
                    </div>
                    <div class="requests-header-actions">
                        <button id="refresh-requests-btn" class="btn btn-secondary">
                            <i data-feather="refresh-cw"></i>
                            <span>Yangilash</span>
                        </button>
                        <button id="bulk-approve-all-btn" class="btn btn-success" style="display: none;">
                            <i data-feather="check-circle"></i>
                            <span>Barchasini Tasdiqlash</span>
                        </button>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="requests-stats-grid">
                    <div class="stat-card stat-card-warning stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="pending-requests-count">0</h3>
                            <p class="stat-label">Kutilayotgan So'rovlar</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="alert-circle"></i>
                            <span id="pending-requests-text">Tasdiqlash kutilmoqda</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-info stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="calendar"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="today-requests-count">0</h3>
                            <p class="stat-label">Bugungi So'rovlar</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="trending-up"></i>
                            <span id="today-requests-trend">+0%</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-success stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="approved-today-count">0</h3>
                            <p class="stat-label">Bugun Tasdiqlangan</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="user-check"></i>
                            <span id="approval-rate">0%</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-danger stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="x-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="rejected-today-count">0</h3>
                            <p class="stat-label">Bugun Rad Etilgan</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="user-x"></i>
                            <span id="rejection-rate">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="card">
                    <div class="requests-filters-section">
                        <!-- Status Filter -->
                        <div class="filter-group">
                            <label class="filter-label">
                                <i data-feather="filter"></i>
                                So'rovlar holati
                            </label>
                            <div class="filter-badges" id="requests-status-badges">
                                <button class="filter-badge active" data-request-status="">
                                    <span>Barchasi <span class="badge-count" id="request-status-count-all">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-warning" data-request-status="pending_telegram_subscription">
                                    <i data-feather="send"></i>
                                    <span>Telegram kutmoqda <span class="badge-count" id="request-status-count-telegram">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-info" data-request-status="pending_admin_approval">
                                    <i data-feather="user-check"></i>
                                    <span>Admin tasdiq <span class="badge-count" id="request-status-count-admin">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-secondary" data-request-status="status_in_process">
                                    <i data-feather="loader"></i>
                                    <span>Jarayonda <span class="badge-count" id="request-status-count-process">0</span></span>
                                </button>
                            </div>
                        </div>

                        <!-- Sort Options -->
                        <div class="filter-group">
                            <label class="filter-label">
                                <i data-feather="sliders"></i>
                                Saralash
                            </label>
                            <div class="sort-buttons">
                                <button class="sort-btn active" data-sort="newest">
                                    <i data-feather="clock"></i>
                                    <span>Eng yangi</span>
                                </button>
                                <button class="sort-btn" data-sort="oldest">
                                    <i data-feather="archive"></i>
                                    <span>Eng eski</span>
                                </button>
                                <button class="sort-btn" data-sort="name">
                                    <i data-feather="type"></i>
                                    <span>Ism bo'yicha</span>
                                </button>
                            </div>
                        </div>

                        <!-- Bulk Actions for Requests -->
                        <div class="filter-group bulk-actions-group" id="requests-bulk-actions" style="display: none;">
                            <label class="filter-label">
                                <i data-feather="check-square"></i>
                                Tanlangan: <span id="requests-selected-count">0</span>
                            </label>
                            <div class="bulk-actions-buttons">
                                <button class="btn btn-sm btn-success" id="requests-bulk-approve-btn">
                                    <i data-feather="check"></i> Tasdiqlash
                                </button>
                                <button class="btn btn-sm btn-danger" id="requests-bulk-reject-btn">
                                    <i data-feather="x"></i> Rad etish
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Requests List -->
                    <div id="pending-users-list" class="requests-grid">
                        <!-- JS orqali to'ldiriladi -->
                    </div>
                </div>
            </section>

            <!-- Foydalanuvchilarni Boshqarish -->
            <section id="users" class="page" data-permission="users:view">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">
                            <i data-feather="users"></i>
                            Foydalanuvchilarni Boshqarish
                        </h1>
                        <p class="page-description">
                            Foydalanuvchilarni qo'shish, tahrirlash va boshqarish
                        </p>
                    </div>
                    <div class="users-header-actions">
                        <button id="refresh-users-btn" class="btn btn-secondary">
                            <i data-feather="refresh-cw"></i>
                            <span>Yangilash</span>
                        </button>
                        <button id="open-add-user-modal-btn" class="btn btn-primary" data-permission="users:create">
                            <i data-feather="user-plus"></i>
                            <span>Yangi Foydalanuvchi</span>
                        </button>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="users-stats-grid">
                    <div class="stat-card stat-card-primary stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="users"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="total-users-count">0</h3>
                            <p class="stat-label">Jami Foydalanuvchilar</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="trending-up"></i>
                            <span id="total-users-trend">+0%</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-success stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="active-users-count">0</h3>
                            <p class="stat-label">Aktiv Foydalanuvchilar</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="activity"></i>
                            <span id="active-users-percent">0%</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-warning stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="pending-users-count">0</h3>
                            <p class="stat-label">Kutilayotgan</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="alert-circle"></i>
                            <span id="pending-users-text">Tasdiq kutilmoqda</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-danger stat-card-interactive">
                        <div class="stat-icon">
                            <i data-feather="user-x"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="inactive-users-count">0</h3>
                            <p class="stat-label">Noaktiv</p>
                        </div>
                        <div class="stat-trend">
                            <i data-feather="x-circle"></i>
                            <span id="inactive-users-percent">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Modern Filters -->
                <div class="card">
                    <div class="users-filters-section">
                        <!-- Role Filter -->
                        <div class="filter-group">
                            <label class="filter-label">
                                <i data-feather="shield"></i>
                                Rol bo'yicha filter
                            </label>
                            <div class="filter-badges" id="users-role-badges">
                                <button class="filter-badge active" data-role="">
                                    <span>Barchasi <span class="badge-count" id="role-count-all">0</span></span>
                                </button>
                                <!-- JS orqali faqat mavjud rollar dinamik qo'shiladi -->
                            </div>
                        </div>

                        <!-- Account Status Filter -->
                        <div class="filter-group">
                            <label class="filter-label">
                                <i data-feather="user-check"></i>
                                Akkaunt holati
                            </label>
                            <div class="filter-badges" id="users-account-status-badges">
                                <button class="filter-badge active" data-account-status="">
                                    <span>Barchasi <span class="badge-count" id="account-status-count-all">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-success" data-account-status="active">
                                    <i data-feather="check-circle"></i>
                                    <span>Faol <span class="badge-count" id="account-status-count-active">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-warning" data-account-status="pending">
                                    <i data-feather="clock"></i>
                                    <span>Kutmoqda <span class="badge-count" id="account-status-count-pending">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-danger" data-account-status="inactive">
                                    <i data-feather="x-circle"></i>
                                    <span>Noaktiv <span class="badge-count" id="account-status-count-inactive">0</span></span>
                                </button>
                            </div>
                        </div>

                        <!-- Online Status Filter -->
                        <div class="filter-group">
                            <label class="filter-label">
                                <i data-feather="activity"></i>
                                Online status
                            </label>
                            <div class="filter-badges" id="users-online-status-badges">
                                <button class="filter-badge active" data-online-status="">
                                    <span>Barchasi <span class="badge-count" id="online-status-count-all">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-success" data-online-status="online">
                                    <i data-feather="wifi"></i>
                                    <span>Online <span class="badge-count" id="online-status-count-online">0</span></span>
                                </button>
                                <button class="filter-badge filter-badge-secondary" data-online-status="offline">
                                    <i data-feather="wifi-off"></i>
                                    <span>Offline <span class="badge-count" id="online-status-count-offline">0</span></span>
                                </button>
                            </div>
                        </div>

                        <!-- Bulk Actions -->
                        <div class="filter-group bulk-actions-group" id="bulk-actions-container" style="display: none;">
                            <label class="filter-label">
                                <i data-feather="check-square"></i>
                                Tanlangan: <span id="selected-count">0</span>
                            </label>
                            <div class="bulk-actions-buttons">
                                <button class="btn btn-sm btn-success" id="bulk-activate-btn">
                                    <i data-feather="check"></i> Faollashtirish
                                </button>
                                <button class="btn btn-sm btn-warning" id="bulk-deactivate-btn">
                                    <i data-feather="x"></i> Deaktiv qilish
                                </button>
                                <button class="btn btn-sm btn-danger" id="bulk-delete-btn">
                                    <i data-feather="trash-2"></i> O'chirish
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Users List -->
                    <div id="user-list-container" class="users-grid">
                        <!-- JS orqali to'ldiriladi -->
                    </div>
                </div>
            </section>

            <!-- Xavfsizlik va Sessiyalar -->
            <section id="security" class="page">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                            </svg>
                            Xavfsizlik va Sessiyalar
                        </h1>
                        <p class="page-description">
                            Real-time sessiya monitoring, xavfsizlik tahlili va boshqaruv
                        </p>
                    </div>
                    <div class="security-header-actions">
                        <button id="refresh-security-btn" class="btn btn-secondary">
                            <i data-feather="refresh-cw"></i>
                            <span>Yangilash</span>
                        </button>
                        <button id="terminate-all-btn" class="btn btn-danger">
                            <i data-feather="log-out"></i>
                            <span>Barcha Sessiyalarni Tugatish</span>
                        </button>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="security-stats-grid">
                    <div class="stat-card stat-card-primary">
                        <div class="stat-icon">
                            <i data-feather="smartphone"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="my-sessions-count">0</h3>
                            <p class="stat-label">Mening Sessiyalarim</p>
                        </div>
                    </div>
                    <div class="stat-card stat-card-success">
                        <div class="stat-icon">
                            <i data-feather="monitor"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="active-devices-count">0</h3>
                            <p class="stat-label">Faol Qurilmalar</p>
                        </div>
                    </div>
                    <div class="stat-card stat-card-warning">
                        <div class="stat-icon">
                            <i data-feather="clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="last-login-time">--:--</h3>
                            <p class="stat-label">Oxirgi Kirish</p>
                        </div>
                    </div>
                    <div class="stat-card stat-card-danger">
                        <div class="stat-icon">
                            <i data-feather="shield"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value" id="security-level">--</h3>
                            <p class="stat-label">Xavfsizlik Darajasi</p>
                        </div>
                    </div>
                </div>

                <!-- Tabs Navigation -->
                <div class="security-tabs">
                    <button class="security-tab active" data-tab="my-sessions">
                        <i data-feather="smartphone"></i>
                        <span>Mening Sessiyalarim</span>
                    </button>
                    <button class="security-tab" data-tab="all-sessions" data-permission="admin:system_settings">
                        <i data-feather="users"></i>
                        <span>Barcha Sessiyalar</span>
                    </button>
                    <button class="security-tab" data-tab="security-logs">
                        <i data-feather="file-text"></i>
                        <span>Xavfsizlik Jurnali</span>
                    </button>
                    <button class="security-tab" data-tab="security-settings" data-permission="admin:system_settings">
                        <i data-feather="settings"></i>
                        <span>Sozlamalar</span>
                    </button>
                </div>

                <!-- Tab Contents -->
                <div class="security-tab-contents">
                    <!-- My Sessions Tab -->
                    <div id="my-sessions-tab" class="security-tab-content active">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i data-feather="smartphone"></i>
                                    Mening Aktiv Sessiyalarim
                                </h3>
                                <span class="session-count-badge" id="my-sessions-count">0 ta sessiya</span>
                            </div>
                            <div id="my-sessions-list" class="sessions-table-container">
                                <!-- JS orqali to'ldiriladi -->
                            </div>
                        </div>
                    </div>

                    <!-- All Sessions Tab -->
                    <div id="all-sessions-tab" class="security-tab-content">
                        <!-- Admin Statistics -->
                        <div class="security-stats-grid" style="margin-bottom: 20px;">
                            <div class="stat-card stat-card-primary">
                                <div class="stat-icon">
                                    <i data-feather="activity"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 class="stat-value" id="total-sessions-count">0</h3>
                                    <p class="stat-label">Jami Aktiv Sessiyalar</p>
                                </div>
                            </div>
                            <div class="stat-card stat-card-success">
                                <div class="stat-icon">
                                    <i data-feather="users"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 class="stat-value" id="active-users-count">0</h3>
                                    <p class="stat-label">Onlayn Foydalanuvchilar</p>
                                </div>
                            </div>
                            <div class="stat-card stat-card-warning">
                                <div class="stat-icon">
                                    <i data-feather="trending-up"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 class="stat-value" id="login-today-count">0</h3>
                                    <p class="stat-label">Bugun Kirganlar (24s)</p>
                                </div>
                            </div>
                            <div class="stat-card stat-card-danger">
                                <div class="stat-icon">
                                    <i data-feather="alert-triangle"></i>
                                </div>
                                <div class="stat-content">
                                    <h3 class="stat-value" id="failed-attempts-count">0</h3>
                                    <p class="stat-label">Muvaffaqiyatsiz Urinishlar</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i data-feather="users"></i>
                                    Barcha Faol Sessiyalar
                                </h3>
                                <div class="filter-controls">
                                    <select id="session-user-filter" class="filter-select">
                                        <option value="">Barcha foydalanuvchilar</option>
                                    </select>
                                    <select id="session-device-filter" class="filter-select">
                                        <option value="">Barcha qurilmalar</option>
                                        <option value="desktop">Desktop</option>
                                        <option value="mobile">Mobile</option>
                                        <option value="tablet">Tablet</option>
                                    </select>
                                </div>
                            </div>
                            <div id="all-sessions-list" class="sessions-table-container">
                                <!-- JS orqali to'ldiriladi -->
                            </div>
                        </div>
                    </div>

                    <!-- Security Logs Tab -->
                    <div id="security-logs-tab" class="security-tab-content">
                        <div class="card">
                            <div class="card-header">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <i data-feather="file-text"></i>
                                    <h3 class="card-title" style="margin: 0;">Xavfsizlik Hodisalari</h3>
                                    <span class="live-indicator" id="logs-live-indicator">
                                        <span class="pulse-dot"></span>
                                        Live
                                    </span>
                                </div>
                                
                                <!-- Modern Filters -->
                                <div class="modern-filters">
                                    <!-- Event Type Filter -->
                                    <div class="filter-group">
                                        <label class="filter-label">
                                            <i data-feather="filter"></i>
                                            Hodisa turi
                                        </label>
                                        <div class="filter-badges" id="log-type-badges">
                                            <button class="filter-badge active" data-type="">
                                                <span>Barchasi <span class="badge-count" id="count-all">0</span></span>
                                            </button>
                                            <button class="filter-badge filter-badge-success" data-type="login">
                                                <i data-feather="log-in"></i>
                                                <span>Kirish <span class="badge-count" id="count-login">0</span></span>
                                            </button>
                                            <button class="filter-badge filter-badge-info" data-type="logout">
                                                <i data-feather="log-out"></i>
                                                <span>Chiqish <span class="badge-count" id="count-logout">0</span></span>
                                            </button>
                                            <button class="filter-badge filter-badge-danger" data-type="failed">
                                                <i data-feather="x-circle"></i>
                                                <span>Muvaffaqiyatsiz <span class="badge-count" id="count-failed">0</span></span>
                                            </button>
                                            <button class="filter-badge filter-badge-blocked" data-type="blocked">
                                                <i data-feather="shield-off"></i>
                                                <span>Bloklangan <span class="badge-count" id="count-blocked">0</span></span>
                                            </button>
                                            <button class="filter-badge filter-badge-warning" data-type="suspicious">
                                                <i data-feather="alert-triangle"></i>
                                                <span>Shubhali <span class="badge-count" id="count-suspicious">0</span></span>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Date Range Filter -->
                                    <div class="filter-group">
                                        <label class="filter-label">
                                            <i data-feather="calendar"></i>
                                            Sana
                                        </label>
                                        <div class="date-filter-buttons">
                                            <button class="date-filter-btn active" data-range="today">Bugun</button>
                                            <button class="date-filter-btn" data-range="yesterday">Kecha</button>
                                            <button class="date-filter-btn" data-range="week">Bu hafta</button>
                                            <button class="date-filter-btn" data-range="month">Bu oy</button>
                                            <button class="date-filter-btn" data-range="custom">
                                                <i data-feather="calendar"></i>
                                                Tanlash
                                            </button>
                                        </div>
                                        <input type="date" id="log-date-filter" class="filter-input modern-date-input" style="display: none;">
                                    </div>
                                    
                                    <!-- Search Filter -->
                                    <div class="filter-group">
                                        <label class="filter-label">
                                            <i data-feather="search"></i>
                                            Qidiruv
                                        </label>
                                        <div class="search-wrapper">
                                            <i data-feather="search"></i>
                                            <input type="text" id="log-search-input" class="search-input" placeholder="Foydalanuvchi, IP yoki xabar bo'yicha qidirish...">
                                            <button class="search-clear-btn" id="log-search-clear" style="display: none;">
                                                <i data-feather="x"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Logs Timeline -->
                            <div id="security-logs-list" class="logs-timeline">
                                <!-- JS orqali to'ldiriladi -->
                            </div>
                        </div>
                    </div>

                    <!-- Security Settings Tab -->
                    <div id="security-settings-tab" class="security-tab-content">
                        <div class="settings-grid">
                            <div class="card">
                                <h3 class="card-title">
                                    <i data-feather="clock"></i>
                                    Sessiya Sozlamalari
                                </h3>
                                <div class="setting-item">
                                    <label>Sessiya Timeout (daqiqa)</label>
                                    <input type="number" id="session-timeout" class="setting-input" value="60" min="5" max="1440">
                                </div>
                                <div class="setting-item">
                                    <label>Maksimal Sessiyalar Soni</label>
                                    <input type="number" id="max-sessions" class="setting-input" value="5" min="1" max="20">
                                </div>
                                <div class="setting-item">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="remember-me-enabled">
                                        <span>"Meni eslab qol" funksiyasi</span>
                                    </label>
                                </div>
                            </div>

                            <div class="card">
                                <h3 class="card-title">
                                    <i data-feather="shield"></i>
                                    Xavfsizlik Sozlamalari
                                </h3>
                                <div class="setting-item">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="force-2fa">
                                        <span>2FA majburiy qilish</span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="block-multiple-logins">
                                        <span>Bir vaqtda bir qurilmadan kirish</span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <label>Muvaffaqiyatsiz urinishlar chegarasi</label>
                                    <input type="number" id="failed-login-limit" class="setting-input" value="5" min="3" max="10">
                                </div>
                                <div class="setting-item">
                                    <label>Bloklash vaqti (daqiqa)</label>
                                    <input type="number" id="block-duration" class="setting-input" value="30" min="5" max="1440">
                                </div>
                            </div>

                            <div class="card">
                                <h3 class="card-title">
                                    <i data-feather="bell"></i>
                                    Xabarnomalar
                                </h3>
                                <div class="setting-item">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="notify-new-login">
                                        <span>Yangi kirish haqida xabarnoma</span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="notify-failed-login">
                                        <span>Muvaffaqiyatsiz urinish haqida</span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="notify-telegram">
                                        <span>Telegram orqali xabarnoma</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <button id="save-security-settings-btn" class="btn btn-primary btn-lg">
                            <i data-feather="save"></i>
                            <span>Sozlamalarni Saqlash</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Rollar va Huquqlar -->
            <section id="roles" class="page" data-permission="roles:manage">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">üé≠ Rollar va Huquqlar</h1>
                        <p class="page-description">
                            Rollar va foydalanuvchilar uchun dostuplarni boshqaring
                        </p>
                    </div>
                    <div class="roles-header-actions">
                        <button id="add-new-role-btn" class="btn btn-success">
                            <i data-feather="plus"></i>
                            <span>Yangi Rol Qo'shish</span>
                        </button>
                    </div>
                </div>

                <!-- Tab Navigation -->
                <div class="roles-tabs">
                    <button class="roles-tab active" data-tab="roles-permissions">
                        <i data-feather="shield"></i>
                        <span>Rol Huquqlari</span>
                    </button>
                    <button class="roles-tab" data-tab="user-permissions">
                        <i data-feather="user-check"></i>
                        <span>Foydalanuvchi Huquqlari</span>
                    </button>
                    <button class="roles-tab" data-tab="permissions-overview">
                        <i data-feather="list"></i>
                        <span>Barcha Huquqlar</span>
                    </button>
                </div>

                <!-- Tab 1: Rol Huquqlari -->
                <div class="roles-tab-content active" id="roles-permissions-tab" data-content="roles-permissions">
                    <div class="roles-info-banner">
                        <i data-feather="info"></i>
                        <div>
                            <strong>Rol huquqlari:</strong> Har bir rol uchun ruxsat etilgan amallarni belgilang.
                        </div>
                    </div>

                    <div id="roles-management-container" class="roles-management-container">
                        <div class="roles-list-panel">
                            <div class="roles-list-header">
                                <h3>
                                    <i data-feather="layers"></i>
                                    <span>Rollar Ro'yxati</span>
                                </h3>
                                <div class="roles-list-search">
                                    <input type="text" id="roles-search-input" class="form-control" placeholder="Rol qidirish...">
                                    <i data-feather="search"></i>
                                </div>
                            </div>
                            <ul id="roles-list" class="roles-list"></ul>
                        </div>
                        <div class="permissions-panel card">
                            <div class="permissions-panel-header">
                                <h3 id="current-role-title" class="card-title">
                                    <i data-feather="lock"></i>
                                    <span>Huquqlarni sozlash</span>
                                </h3>
                                <div class="permissions-panel-actions">
                                    <button id="select-all-permissions-btn" class="btn-icon" title="Barchasini belgilash" aria-label="Barchasini belgilash">
                                        ‚úî
                                    </button>
                                    <button id="deselect-all-permissions-btn" class="btn-icon" title="Barchasini olib tashlash" aria-label="Barchasini olib tashlash">
                                        ‚úñ
                                    </button>
                                </div>
                            </div>
                            <div id="permissions-grid" class="permissions-grid"></div>
                            <div class="page-footer">
                                <button id="save-role-permissions-btn" class="btn btn-primary hidden">
                                    <i data-feather="save"></i> 
                                    <span>O'zgarishlarni Saqlash</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 2: Foydalanuvchi Huquqlari -->
                <div class="roles-tab-content" id="user-permissions-tab" data-content="user-permissions">
                    <div class="roles-info-banner info">
                        <i data-feather="info"></i>
                        <div>
                            <strong>Foydalanuvchi huquqlari:</strong> Alohida foydalanuvchilar uchun qo'shimcha huquqlar bering yoki cheklang.
                        </div>
                    </div>

                    <div class="user-permissions-container">
                        <div class="user-permissions-list">
                            <div class="user-permissions-header">
                                <h3>
                                    <i data-feather="users"></i>
                                    <span>Foydalanuvchilar</span>
                                </h3>
                                <div class="user-permissions-search">
                                    <input type="text" id="user-permissions-search-input" class="form-control" placeholder="Foydalanuvchi qidirish...">
                                    <i data-feather="search"></i>
                                </div>
                            </div>
                            <div id="user-permissions-list" class="users-permissions-list">
                                <!-- Dynamic content -->
                            </div>
                        </div>

                        <div class="user-permissions-panel card">
                            <div class="user-permissions-panel-header">
                                <div class="user-permissions-info">
                                    <div class="user-avatar" id="selected-user-avatar">U</div>
                                    <div>
                                        <h3 id="selected-user-name">Foydalanuvchini tanlang</h3>
                                        <p id="selected-user-role">-</p>
                                    </div>
                                </div>
                                <div class="user-permissions-actions">
                                    <button id="reset-user-permissions-btn" class="btn btn-warning btn-sm" style="display: none;">
                                        <i data-feather="rotate-ccw"></i>
                                        <span>Aslini qaytarish</span>
                                    </button>
                                </div>
                            </div>

                            <div class="user-permissions-tabs">
                                <button class="user-perm-tab active" data-type="additional">
                                    <i data-feather="plus-circle"></i>
                                    <span>Qo'shimcha Huquqlar</span>
                                </button>
                                <button class="user-perm-tab" data-type="restricted">
                                    <i data-feather="minus-circle"></i>
                                    <span>Cheklangan Huquqlar</span>
                                </button>
                            </div>

                            <!-- Dual Panel: Available vs Assigned -->
                            <div id="user-permissions-content" class="user-permissions-dual-panel">
                                <!-- Available Permissions (Left) -->
                                <div class="permissions-column">
                                    <div class="permissions-column-header">
                                        <div class="header-title-row">
                                            <h4>
                                                <i data-feather="package"></i>
                                                <span>Mavjud Huquqlar</span>
                                            </h4>
                                            <span class="permissions-stats" id="available-stats">0 ta</span>
                                        </div>
                                        <select id="available-filter" class="filter-select">
                                            <option value="">Barcha bo'limlar</option>
                                        </select>
                                    </div>
                                    <div class="permissions-list" id="available-permissions-list">
                                        <div class="empty-state">
                                            <i data-feather="user"></i>
                                            <p>Foydalanuvchini tanlang</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Transfer Buttons (Center) -->
                                <div class="permissions-transfer-buttons">
                                    <button id="add-selected-perms-btn" class="btn btn-icon btn-primary" title="Qo'shish">
                                        <i data-feather="chevron-right"></i>
                                    </button>
                                    <button id="add-all-perms-btn" class="btn btn-icon btn-secondary" title="Barchasini qo'shish">
                                        <i data-feather="chevrons-right"></i>
                                    </button>
                                    <button id="remove-all-perms-btn" class="btn btn-icon btn-secondary" title="Barchasini olib tashlash">
                                        <i data-feather="chevrons-left"></i>
                                    </button>
                                    <button id="remove-selected-perms-btn" class="btn btn-icon btn-danger" title="Olib tashlash">
                                        <i data-feather="chevron-left"></i>
                                    </button>
                                </div>

                                <!-- Assigned Permissions (Right) -->
                                <div class="permissions-column">
                                    <div class="permissions-column-header">
                                        <div class="header-title-row">
                                            <h4>
                                                <i data-feather="check-circle"></i>
                                                <span id="assigned-title">Qo'shimcha Huquqlar</span>
                                            </h4>
                                            <span class="permissions-stats" id="assigned-stats">0 ta</span>
                                        </div>
                                        <select id="assigned-filter" class="filter-select">
                                            <option value="">Barcha bo'limlar</option>
                                        </select>
                                    </div>
                                    <div class="permissions-list" id="assigned-permissions-list">
                                        <div class="empty-state">
                                            <i data-feather="inbox"></i>
                                            <p>Huquqlar yo'q</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="page-footer" id="user-permissions-footer" style="display: none;">
                                <button id="save-user-permissions-btn" class="btn btn-primary">
                                    <i data-feather="save"></i>
                                    <span>Saqlash</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 3: Barcha Huquqlar -->
                <div class="roles-tab-content" id="permissions-overview-tab" data-content="permissions-overview">
                    <div class="roles-info-banner success">
                        <i data-feather="info"></i>
                        <div>
                            <strong>Huquqlar ro'yxati:</strong> Tizimdagi barcha mavjud huquqlar va ularning tavsifi.
                        </div>
                    </div>

                    <div class="permissions-overview-grid" id="permissions-overview-grid">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </section>

            <!-- Tizim Jurnali -->
            <section id="audit-log" class="page" data-permission="audit:view">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">üìú Tizim Jurnali</h1>
                        <p class="page-description">
                            Tizimda sodir bo'lgan barcha muhim harakatlar va hodisalar tarixi
                        </p>
                    </div>
                    <div class="audit-stats">
                        <div class="audit-stat-item">
                            <div class="audit-stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <i data-feather="activity"></i>
                            </div>
                            <div class="audit-stat-info">
                                <span class="audit-stat-value" id="total-logs-count">0</span>
                                <span class="audit-stat-label">Jami yozuvlar</span>
                            </div>
                        </div>
                        <div class="audit-stat-item">
                            <div class="audit-stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                <i data-feather="clock"></i>
                            </div>
                            <div class="audit-stat-info">
                                <span class="audit-stat-value" id="today-logs-count">0</span>
                                <span class="audit-stat-label">Bugun</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Filter Card -->
                <div class="card audit-filter-card">
                    <div class="audit-filter-header">
                        <div class="filter-header-left">
                            <i data-feather="filter"></i>
                            <h3>Filtrlar</h3>
                        </div>
                        <button id="audit-filter-toggle-btn" class="btn-icon-minimal">
                            <i data-feather="chevron-down"></i>
                        </button>
                    </div>
                    <div class="audit-filter-content" id="audit-filter-content">
                        <div class="filter-grid">
                            <div class="filter-item">
                                <label for="audit-user-filter">
                                    <i data-feather="user"></i>
                                    <span>Foydalanuvchi</span>
                                </label>
                                <select id="audit-user-filter" class="form-control modern-select">
                                    <option value="">Barcha foydalanuvchilar</option>
                                </select>
                            </div>
                            <div class="filter-item">
                                <label for="audit-action-filter">
                                    <i data-feather="zap"></i>
                                    <span>Amal Turi</span>
                                </label>
                                <select id="audit-action-filter" class="form-control modern-select">
                                    <option value="">Barcha amallar</option>
                                </select>
                            </div>
                            <div class="filter-item">
                                <label for="audit-date-filter">
                                    <i data-feather="calendar"></i>
                                    <span>Sana Oralig'i</span>
                                </label>
                                <input type="text" id="audit-date-filter" class="form-control" placeholder="Sanani tanlang...">
                            </div>
                            <div class="filter-item">
                                <label for="audit-search-input">
                                    <i data-feather="search"></i>
                                    <span>Qidiruv</span>
                                </label>
                                <input type="text" id="audit-search-input" class="form-control" placeholder="Tavsif yoki ma'lumot...">
                            </div>
                        </div>
                        <div class="filter-actions">
                            <button id="audit-filter-apply-btn" class="btn btn-primary">
                                <i data-feather="check"></i>
                                <span>Qo'llash</span>
                            </button>
                            <button id="audit-filter-reset-btn" class="btn btn-secondary">
                                <i data-feather="x"></i>
                                <span>Tozalash</span>
                            </button>
                            <button id="audit-export-btn" class="btn btn-success">
                                <i data-feather="download"></i>
                                <span>Eksport</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Audit Log Table -->
                <div class="card audit-table-card">
                    <div class="audit-table-header">
                        <h3>
                            <i data-feather="list"></i>
                            <span>Jurnal yozuvlari</span>
                        </h3>
                        <div class="audit-table-actions">
                            <button id="audit-refresh-btn" class="btn-icon" title="Yangilash" aria-label="Yangilash">
                                ‚ü≥
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table audit-table">
                            <thead>
                                <tr>
                                    <th style="width: 50px;"></th>
                                    <th style="width: 150px;">Vaqt</th>
                                    <th style="width: 140px;">Foydalanuvchi</th>
                                    <th style="width: 140px;">Amal</th>
                                    <th>Tavsif</th>
                                    <th style="width: 180px;">Qurilma</th>
                                    <th style="width: 50px;"></th>
                                </tr>
                            </thead>
                            <tbody id="audit-log-table-body">
                                <!-- Dynamic content -->
                            </tbody>
                        </table>
                    </div>
                    <div class="audit-table-footer">
                        <div class="audit-table-info">
                            <span id="audit-showing-info">0 dan 0 gacha ko'rsatilmoqda</span>
                        </div>
                        <div id="audit-log-pagination" class="pagination-controls"></div>
                    </div>
                </div>
            </section>

            <!-- Admin Boshqaruvi -->
            <section id="admin-controls" class="page" data-permission="roles:manage">
                <div class="page-header"><h1 class="page-title">Admin Boshqaruvi</h1></div>
                
                <!-- === üíæ TO'LIQ MA'LUMOTLAR BAZASI EXPORT/IMPORT === -->
                <div class="card">
                    <div class="db-export-header">
                        <h3 class="db-export-title">
                            <i data-feather="database"></i>
                            <span>üíæ To'liq Ma'lumotlar Bazasi Boshqaruvi</span>
                        </h3>
                        <p class="db-export-description">
                            Barcha ma'lumotlarni (foydalanuvchilar, hisobotlar, tarix, sozlamalar) bir faylda saqlash va qayta yuklash. 
                            Backup yaratish yoki yangi serverga ko'chirish uchun ideal.
                        </p>
                    </div>
                    
                    <div style="padding: 30px;">
                        <div class="export-import-grid">
                            <!-- Export kartasi -->
                            <div class="export-import-card">
                                <div class="card-icon export">
                                    <i data-feather="download-cloud"></i>
                                </div>
                                <h4>üì• Export (Yuklab olish)</h4>
                                <p>Barcha ma'lumotlarni JSON faylda saqlang. Shu faylni keyin import qilsangiz, hozirgi holatga qaytadi.</p>
                                <button id="export-full-db-btn" class="btn btn-export">
                                    <i data-feather="download"></i>
                                    <span>To'liq Eksport</span>
                                </button>
                                <div id="export-info" class="info-box">
                                    <i data-feather="check-circle"></i>
                                    <div>
                                        <strong>‚úÖ Qamrab olinadi:</strong>
                                        <ul>
                                            <li>üë• Barcha foydalanuvchilar</li>
                                            <li>üìä Barcha hisobotlar</li>
                                            <li>üìú To'liq tarix (audit log)</li>
                                            <li>üé≠ Rollar va huquqlar</li>
                                            <li>‚öôÔ∏è Sozlamalar</li>
                                            <li>üè∑Ô∏è Brendlar va filiallar</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Import kartasi -->
                            <div class="export-import-card">
                                <div class="card-icon import">
                                    <i data-feather="upload-cloud"></i>
                                </div>
                                <h4>üì§ Import (Yuklash)</h4>
                                <p>Avval export qilingan JSON faylni tanlang. Barcha ma'lumotlar qayta tiklanadi.</p>
                                <input type="file" id="import-file-input" accept=".json" style="display: none;">
                                <button id="import-full-db-btn" class="btn btn-import">
                                    <i data-feather="upload"></i>
                                    <span class="btn-text">Faylni Tanlash</span>
                                </button>
                                <div id="selected-file-info" class="selected-file-info hidden">
                                    <i data-feather="file-text"></i>
                                    <span class="file-name"></span>
                                </div>
                                <div id="import-info" class="info-box warning">
                                    <i data-feather="alert-triangle"></i>
                                    <div>
                                        <strong>‚ö†Ô∏è Muhim diqqat:</strong>
                                        <p>Import qilish hozirgi barcha ma'lumotlarni o'chiradi va yangi ma'lumotlarni yuklaydi! Iltimos, oldin backup qiling.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Progress bar -->
                        <div id="db-operation-progress" class="progress-container hidden">
                            <div class="progress-header">
                                <h4 class="progress-title">Jarayon davom etmoqda...</h4>
                                <span class="progress-percentage">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                            <p class="progress-text">Iltimos kuting...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Tizim Boshqaruvi -->
                <div class="card admin-control-card">
                    <div class="admin-control-header">
                        <div class="admin-control-icon">
                            <i data-feather="settings"></i>
                        </div>
                        <div>
                            <h3 class="card-title">üîß Tizim Boshqaruvi</h3>
                            <p class="card-subtitle">Database backup va sessiya boshqaruvi</p>
                        </div>
                    </div>
                    
                    <div class="admin-control-section">
                        <div class="control-item">
                            <div class="control-item-header">
                                <div class="control-item-icon database">
                                    <i data-feather="database"></i>
                                </div>
                                <div class="control-item-info">
                                    <h4>Ma'lumotlar Bazasi</h4>
                                    <p>Database'ning oddiy nusxasini yuklab olish</p>
                                </div>
                            </div>
                            <button id="backup-db-btn" class="btn btn-control btn-secondary">
                                <i data-feather="download"></i>
                                <span>Baza nusxasini yuklab olish</span>
                            </button>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-item-header">
                                <div class="control-item-icon sessions">
                                    <i data-feather="users"></i>
                                </div>
                                <div class="control-item-info">
                                    <h4>Foydalanuvchi Sessiyalari</h4>
                                    <p>Barcha foydalanuvchilarni tizimdan chiqarish</p>
                                </div>
                            </div>
                            <button id="clear-sessions-btn" class="btn btn-control btn-danger">
                                <i data-feather="trash-2"></i>
                                <span>Barcha sessiyalarni tozalash</span>
                            </button>
                            <div class="control-item-warning">
                                <i data-feather="alert-triangle"></i>
                                <span>Bu amal o'zingizdan tashqari barcha foydalanuvchilarni tizimdan chiqarib yuboradi.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- üé® ZAMONAVIY BRENDING -->
            <section id="branding" class="page" data-permission="settings:edit_general">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">üé® Dizayn va Brending</h1>
                        <p class="page-description">
                            Tizimning ko'rinishini o'zgartiring: logotip, ranglar, yozuvlar va boshqalar
                        </p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button id="reset-branding-btn" class="btn btn-danger" title="Boshlang'ich holatga qaytarish">
                            <i data-feather="refresh-cw"></i> Boshlang'ich holat
                        </button>
                    </div>
                </div>

                <!-- BO'LIMLAR TABI -->
                <div class="branding-tabs">
                    <button class="branding-tab active" data-tab="logo" title="Logotip va brend matni">
                        <i data-feather="file-text"></i>
                        <span>Logotip</span>
                    </button>
                    <button class="branding-tab" data-tab="colors" title="Ranglarni o'zgartirish">
                        <i data-feather="droplet"></i>
                        <span>Ranglar</span>
                    </button>
                    <button class="branding-tab" data-tab="typography" title="Shrift va yozuv uslubi">
                        <i data-feather="type"></i>
                        <span>Yozuvlar</span>
                    </button>
                    <button class="branding-tab" data-tab="animations" title="Animatsiya va harakatlar">
                        <i data-feather="zap"></i>
                        <span>Animatsiyalar</span>
                    </button>
                    <button class="branding-tab" data-tab="components" title="Tugma, karta va inputlar">
                        <i data-feather="box"></i>
                        <span>Elementlar</span>
                    </button>
                    <button class="branding-tab" data-tab="spacing" title="Masofalar va bo'shliqlar">
                        <i data-feather="maximize-2"></i>
                        <span>Masofalar</span>
                    </button>
                    <button class="branding-tab" data-tab="loader" title="Yuklanish animatsiyasi">
                        <i data-feather="loader"></i>
                        <span>Loader</span>
                    </button>
                </div>

                <!-- TAB CONTENT -->
                <div class="branding-content">
                    
                    <!-- 1Ô∏è‚É£ LOGOTIP -->
                    <div class="branding-tab-content active" data-content="logo">
                        <div class="branding-grid">
                            <div class="branding-settings">
                                <h3 class="section-title">üìù Logotip Sozlamalari</h3>
                                <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 13px;">
                                    üéØ Bu yerda o'zgartirishlar: <strong>Yon panel (sidebar)</strong> va <strong>Yuqori qism (header)</strong>
                                </p>
                                
                                <div class="form-group">
                                    <label for="logo-text-input">üìÑ Logotip matni</label>
                                    <input type="text" id="logo-text-input" class="form-control" placeholder="MANUS">
                                    <small style="color: var(--text-secondary); margin-top: 5px; display: block;">Tizim nomini kiriting</small>
                                </div>

                                <div class="form-group">
                                    <label>üé® Logotip rangi</label>
                                    <div class="color-picker-wrapper">
                                        <input type="color" id="logo-color-picker" class="color-input" value="#4CAF50">
                                        <input type="text" id="logo-color-hex" class="form-control" placeholder="#4CAF50" style="width: 100px;">
                                    </div>
                                    <small style="color: var(--text-secondary); margin-top: 5px; display: block;">Rang kodini kiriting yoki tanlang</small>
                                </div>

                                <div class="form-group">
                                    <label>üåà Tayyor ranglar</label>
                                    <div id="logo-color-palette" class="color-palette"></div>
                                </div>

                                <div class="form-group">
                                    <label for="logo-size-input">üìè Logotip o'lchami</label>
                                    <input type="range" id="logo-size-input" class="range-input" min="16" max="48" value="32" step="2">
                                    <span class="range-value" id="logo-size-value">32px</span>
                                    <small style="color: var(--text-secondary); margin-top: 5px; display: block;">Kichik (16px) dan Katta (48px) gacha</small>
                                </div>

                                <div class="form-group">
                                    <label for="logo-animation-select">‚ú® Animatsiya turi</label>
                                    <select id="logo-animation-select" class="form-control"></select>
                                    <small style="color: var(--text-secondary); margin-top: 5px; display: block;">Logotip harakati</small>
                                </div>

                                <div class="form-group">
                                    <label for="logo-border-effect-select">üñºÔ∏è Chegara effekti</label>
                                    <select id="logo-border-effect-select" class="form-control"></select>
                                    <small style="color: var(--text-secondary); margin-top: 5px; display: block;">Logotip atrofidagi chegara</small>
                                </div>
                            </div>

                            <div class="branding-preview-panel">
                                <h3 class="section-title">üëÅÔ∏è Ko'rib chiqish</h3>
                                <div class="preview-container">
                                    <div id="logo-preview-container" class="logo-border-effect">
                                        <div id="logo-preview" class="brand-logo">MANUS</div>
                                    </div>
                                    <p style="color: var(--text-secondary); margin-top: 15px; font-size: 13px; text-align: center;">
                                        <i data-feather="info" style="width: 14px; height: 14px; margin-right: 5px;"></i>
                                        Yon panelda shunday ko'rinadi
                                    </p>
                                </div>
                                
                                <!-- QAYERDA TA'SIR QILISHI -->
                                <div style="margin-top: 25px; padding: 15px; background: rgba(0, 123, 255, 0.1); border-radius: 8px; border: 1px solid rgba(0, 123, 255, 0.3);">
                                    <h4 style="font-size: 14px; margin-bottom: 12px; color: var(--blue-color);">
                                        üìç Qayerda o'zgaradi?
                                    </h4>
                                    <div style="display: flex; flex-direction: column; gap: 8px; font-size: 13px;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="width: 6px; height: 6px; background: var(--green-color); border-radius: 50%; display: inline-block;"></span>
                                            <span>Yon panel (sidebar) tepasida</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="width: 6px; height: 6px; background: var(--green-color); border-radius: 50%; display: inline-block;"></span>
                                            <span>Asosiy sahifa header qismida</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="width: 6px; height: 6px; background: var(--green-color); border-radius: 50%; display: inline-block;"></span>
                                            <span>Barcha sahifalarda bir xil</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2Ô∏è‚É£ RANGLAR -->
                    <div class="branding-tab-content" data-content="colors">
                        <h3 class="section-title">üé® Tizim Ranglari</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 13px;">
                            üéØ Bu yerda o'zgartirishlar: <strong>Barcha tugmalar, kartalar, xabarlar</strong>
                        </p>
                        
                        <!-- QAYERDA TA'SIR QILISHI -->
                        <div style="margin-bottom: 25px; padding: 15px; background: rgba(0, 123, 255, 0.1); border-radius: 8px; border: 1px solid rgba(0, 123, 255, 0.3);">
                            <h4 style="font-size: 14px; margin-bottom: 12px; color: var(--blue-color);">
                                üìç Qayerda o'zgaradi?
                            </h4>
                            <div style="display: flex; flex-direction: column; gap: 8px; font-size: 13px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="width: 6px; height: 6px; background: var(--green-color); border-radius: 50%; display: inline-block;"></span>
                                    <span>Barcha tugmalar va havolalar</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="width: 6px; height: 6px; background: var(--green-color); border-radius: 50%; display: inline-block;"></span>
                                    <span>Muvaffaqiyat/Xato xabarlari</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="width: 6px; height: 6px; background: var(--green-color); border-radius: 50%; display: inline-block;"></span>
                                    <span>Sahifa fonlari va matnlar</span>
                                </div>
                            </div>
                        </div>

                        <div class="colors-grid">
                            <!-- Asosiy Ranglar -->
                            <div class="color-item">
                                <label>ÔøΩ Asosiy rang</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="primary-color" class="color-input" value="#007bff">
                                    <input type="text" class="form-control" value="#007bff" readonly>
                                </div>
                                <p class="color-desc">Tugmalar va havolalar</p>
                            </div>

                            <div class="color-item">
                                <label>ÔøΩ Muvaffaqiyat</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="success-color" class="color-input" value="#28a745">
                                    <input type="text" class="form-control" value="#28a745" readonly>
                                </div>
                                <p class="color-desc">Yaratildi, saqlandi</p>
                            </div>

                            <div class="color-item">
                                <label>ÔøΩ Xatolik</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="danger-color" class="color-input" value="#dc3545">
                                    <input type="text" class="form-control" value="#dc3545" readonly>
                                </div>
                                <p class="color-desc">Xato, o'chirish</p>
                            </div>

                            <div class="color-item">
                                <label>ÔøΩ Ogohlantirish</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="warning-color" class="color-input" value="#ffc107">
                                    <input type="text" class="form-control" value="#ffc107" readonly>
                                </div>
                                <p class="color-desc">Diqqat, kechikish</p>
                            </div>

                            <div class="color-item">
                                <label>‚¨ú Sahifa foni</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="bg-color" class="color-input" value="#1a1d29">
                                    <input type="text" class="form-control" value="#1a1d29" readonly>
                                </div>
                                <p class="color-desc">Asosiy fon rangi</p>
                            </div>

                            <div class="color-item">
                                <label>‚¨õ Yon panel foni</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="sidebar-bg-color" class="color-input" value="#13151f">
                                    <input type="text" class="form-control" value="#13151f" readonly>
                                </div>
                                <p class="color-desc">Sidebar rangi</p>
                            </div>

                            <div class="color-item">
                                <label>üìù Asosiy matn</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="text-primary-color" class="color-input" value="#ffffff">
                                    <input type="text" class="form-control" value="#ffffff" readonly>
                                </div>
                                <p class="color-desc">Sarlavhalar, asosiy</p>
                            </div>

                            <div class="color-item">
                                <label>üìÑ Yordamchi matn</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="text-secondary-color" class="color-input" value="#a0a3bd">
                                    <input type="text" class="form-control" value="#a0a3bd" readonly>
                                </div>
                                <p class="color-desc">Tavsif, yordam</p>
                            </div>
                        </div>

                        <div class="colors-preview-section">
                            <h3 class="section-title">üëÅÔ∏è Ko'rib chiqish</h3>
                            <div class="preview-buttons">
                                <button class="btn btn-primary">Asosiy tugma</button>
                                <button class="btn btn-success">Muvaffaqiyat</button>
                                <button class="btn btn-danger">Xatolik</button>
                                <button class="btn btn-warning" style="color: #000;">Ogohlantirish</button>
                            </div>
                        </div>
                    </div>

                    <!-- 3Ô∏è‚É£ TIPOGRAFIYA -->
                    <div class="branding-tab-content" data-content="typography">
                        <h3 class="section-title">üî§ Shrift Sozlamalari</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">üéØ Bu yerda o'zgartirishlar: <strong>Barcha matnlar</strong> (sarlavhalar, paragraflar, jadvallar)</p>
                        
                        <!-- Impact indicator -->
                        <div style="background: rgba(0, 123, 255, 0.1); border: 1px solid rgba(0, 123, 255, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 25px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 14px; color: #007bff;">üìç Qayerda o'zgaradi?</h4>
                            <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.8;">
                                <div>‚Ä¢ Barcha sahifalar matnlari</div>
                                <div>‚Ä¢ Jadval va karta matnlari</div>
                                <div>‚Ä¢ Tugma va menu matnlari</div>
                            </div>
                        </div>
                        
                        <div class="typography-grid">
                            <div class="form-group">
                                <label for="font-family-select">üî† Shrift turi</label>
                                <select id="font-family-select" class="form-control">
                                    <option value="Inter">Inter (Asosiy)</option>
                                    <option value="Roboto">Roboto</option>
                                    <option value="Open Sans">Open Sans</option>
                                    <option value="Lato">Lato</option>
                                    <option value="Montserrat">Montserrat</option>
                                    <option value="Poppins">Poppins</option>
                                </select>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Tizim shrifti</small>
                            </div>

                            <div class="form-group">
                                <label for="font-size-base">üìè Asosiy o'lcham</label>
                                <input type="range" id="font-size-base" class="range-input" min="12" max="18" value="14" step="1">
                                <span class="range-value" id="font-size-base-value">14px</span>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Oddiy matn</small>
                            </div>

                            <div class="form-group">
                                <label for="heading-size">üìê Sarlavha o'lchami</label>
                                <input type="range" id="heading-size" class="range-input" min="20" max="40" value="28" step="2">
                                <span class="range-value" id="heading-size-value">28px</span>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">H1, H2, H3</small>
                            </div>

                            <div class="form-group">
                                <label for="line-height">‚ÜïÔ∏è Qator balandligi</label>
                                <input type="range" id="line-height" class="range-input" min="1.2" max="2" value="1.6" step="0.1">
                                <span class="range-value" id="line-height-value">1.6</span>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Qatorlar orasi</small>
                            </div>
                        </div>

                        <div class="typography-preview">
                            <h4 style="margin: 20px 0 15px 0; font-size: 14px; color: #007bff;">üëÅÔ∏è Ko'rib chiqish</h4>
                            <h1 style="margin-bottom: 15px;">Katta sarlavha (H1)</h1>
                            <h2 style="margin-bottom: 15px;">O'rtacha sarlavha (H2)</h2>
                            <h3 style="margin-bottom: 15px;">Kichik sarlavha (H3)</h3>
                            <p style="margin-bottom: 10px;">
                                Bu oddiy matn. Hisobotlar va jadvallar uchun ishlatiladi. Ushbu o'lcham va shrift butun tizimda qo'llaniladi.
                            </p>
                            <p style="color: var(--text-secondary);">
                                Bu yordamchi matn. Tavsif va kichik ma'lumotlar uchun.
                            </p>
                        </div>
                    </div>

                    <!-- 4Ô∏è‚É£ ANIMATSIYALAR -->
                    <div class="branding-tab-content" data-content="animations">
                        <h3 class="section-title">‚ú® Animatsiya Sozlamalari</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">üéØ Bu yerda o'zgartirishlar: <strong>Tugmalar, kartalar, menyular</strong></p>
                        
                        <!-- Impact indicator -->
                        <div style="background: rgba(0, 123, 255, 0.1); border: 1px solid rgba(0, 123, 255, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 25px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 14px; color: #007bff;">üìç Qayerda o'zgaradi?</h4>
                            <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.8;">
                                <div>‚Ä¢ Tugmalar hover effekti</div>
                                <div>‚Ä¢ Kartalar va jadvallar</div>
                                <div>‚Ä¢ Menyu ochilishi</div>
                            </div>
                        </div>
                        
                        <div class="animations-grid">
                            <div class="form-group">
                                <label for="transition-speed">‚ö° Harakat tezligi</label>
                                <input type="range" id="transition-speed" class="range-input" min="100" max="1000" value="300" step="50">
                                <span class="range-value" id="transition-speed-value">300ms</span>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Qanchalik tez harakatlanadi</small>
                            </div>

                            <div class="form-group">
                                <label for="animation-easing">üåä Harakat turi</label>
                                <select id="animation-easing" class="form-control">
                                    <option value="ease">Oddiy</option>
                                    <option value="ease-in">Sekin boshlanadi</option>
                                    <option value="ease-out">Sekin tugaydi</option>
                                    <option value="ease-in-out">Ikki tomonga sekin</option>
                                    <option value="linear">Bir xil tezlikda</option>
                                    <option value="cubic-bezier(0.68, -0.55, 0.265, 1.55)">üé™ Sakrash (Bounce)</option>
                                    <option value="cubic-bezier(0.175, 0.885, 0.32, 1.275)">üåü Elastik (Elastic)</option>
                                    <option value="cubic-bezier(0.23, 1, 0.32, 1)">üí´ Yumshoq (Smooth)</option>
                                    <option value="cubic-bezier(0.68, -0.6, 0.32, 1.6)">üöÄ Tez (Fast)</option>
                                    <option value="cubic-bezier(0.33, 1, 0.68, 1)">üéØ Aniq (Sharp)</option>
                                </select>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Qanday harakatlanadi</small>
                            </div>

                            <div class="form-group">
                                <label>üé≠ Sichqoncha effektlari</label>
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable-hover-scale" checked>
                                        <span>Kattalashtirish</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable-hover-shadow" checked>
                                        <span>Soya</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable-hover-lift" checked>
                                        <span>Ko'tarish</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable-hover-glow">
                                        <span>Yorqinlik</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable-hover-rotate">
                                        <span>Aylantirish</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable-hover-slide">
                                        <span>Siljitish</span>
                                    </label>
                                </div>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Hover paytida</small>
                            </div>

                            <div class="form-group">
                                <label for="border-animation">üñºÔ∏è Chegara effekti</label>
                                <select id="border-animation" class="form-control">
                                    <option value="none">Yo'q</option>
                                    <option value="solid">Oddiy</option>
                                    <option value="gradient-border">üåà Gradient chegara</option>
                                    <option value="animated-gradient">‚ú® Animatsion gradient</option>
                                    <option value="neon-glow">üí° Neon yorug'lik</option>
                                    <option value="pulse-border">üíì Pulsatsiya</option>
                                    <option value="rotating-border">üîÑ Aylanuvchi</option>
                                    <option value="dashed-animated">‚ö° Chiziqli harakat</option>
                                </select>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Kartalar va tugmalar chegarasi</small>
                            </div>

                            <div class="form-group">
                                <label for="hover-transform">üé® Hover o'zgarishi</label>
                                <select id="hover-transform" class="form-control">
                                    <option value="none">Yo'q</option>
                                    <option value="scale-up">‚ÜóÔ∏è Kattalashtirish</option>
                                    <option value="scale-down">‚ÜôÔ∏è Kichiklashtirish</option>
                                    <option value="tilt-left">‚Ü∞ Chapga qiyshayish</option>
                                    <option value="tilt-right">‚Ü± O'ngga qiyshayish</option>
                                    <option value="flip-3d">üîÑ 3D aylantirish</option>
                                    <option value="perspective">üìê Perspektiv</option>
                                    <option value="skew">üìä Egilish</option>
                                </select>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Tugmalar ustiga kelganda</small>
                            </div>
                        </div>

                        <div class="animations-preview">
                            <h4 style="margin: 20px 0 15px 0; font-size: 14px; color: #007bff;">üëÅÔ∏è Ko'rib chiqish</h4>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                                <button class="btn btn-primary animation-test-btn">Ustiga keling</button>
                                <button class="btn btn-success animation-test-btn-2">Effekt test</button>
                                <button class="btn btn-danger animation-test-btn-3">Ko'rish</button>
                                <div class="card animation-test-card" style="padding: 20px; cursor: pointer;">
                                    <i data-feather="star" style="margin-bottom: 10px;"></i>
                                    <span>Test karta</span>
                                </div>
                                <div class="card animation-test-card-2" style="padding: 20px; cursor: pointer; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                    <i data-feather="zap" style="margin-bottom: 10px; color: white;"></i>
                                    <span style="color: white;">Gradient</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 5Ô∏è‚É£ KOMPONENTLAR -->
                    <div class="branding-tab-content" data-content="components">
                        <h3 class="section-title">üß© Komponent Stillari</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">üéØ Bu yerda o'zgartirishlar: <strong>Tugmalar, kartalar, input maydonlari</strong></p>
                        
                        <!-- Impact indicator -->
                        <div style="background: rgba(0, 123, 255, 0.1); border: 1px solid rgba(0, 123, 255, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 25px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 14px; color: #007bff;">üìç Qayerda o'zgaradi?</h4>
                            <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.8;">
                                <div>‚Ä¢ Barcha tugmalar burchaklari</div>
                                <div>‚Ä¢ Kartalar va jadvallar ko'rinishi</div>
                                <div>‚Ä¢ Input va select maydonlari</div>
                            </div>
                        </div>
                        
                        <div class="components-settings">
                            <!-- Tugmalar -->
                            <div class="component-section">
                                <h4>üîò Tugmalar</h4>
                                <div class="form-group">
                                    <label for="button-radius">‚ÜóÔ∏è Burchak o'lchami</label>
                                    <input type="range" id="button-radius" class="range-input" min="0" max="30" value="6" step="2">
                                    <span class="range-value" id="button-radius-value">6px</span>
                                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Tugma burchaklari</small>
                                </div>
                                <div class="form-group">
                                    <label for="button-padding">üì¶ Ichki bo'shliq</label>
                                    <input type="range" id="button-padding" class="range-input" min="6" max="20" value="12" step="2">
                                    <span class="range-value" id="button-padding-value">12px</span>
                                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Tugma hajmi</small>
                                </div>
                                <div class="preview-buttons">
                                    <button class="btn btn-primary component-preview-btn">Asosiy</button>
                                    <button class="btn btn-secondary component-preview-btn">Ikkilamchi</button>
                                    <button class="btn btn-danger component-preview-btn">Xatolik</button>
                                </div>
                            </div>

                            <!-- Kartalar -->
                            <div class="component-section">
                                <h4>üÉè Kartalar</h4>
                                <div class="form-group">
                                    <label for="card-radius">‚ÜóÔ∏è Burchak o'lchami</label>
                                    <input type="range" id="card-radius" class="range-input" min="0" max="30" value="12" step="2">
                                    <span class="range-value" id="card-radius-value">12px</span>
                                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Karta burchaklari</small>
                                </div>
                                <div class="form-group">
                                    <label for="card-shadow">üåë Soya kuchi</label>
                                    <input type="range" id="card-shadow" class="range-input" min="0" max="10" value="3" step="1">
                                    <span class="range-value" id="card-shadow-value">3</span>
                                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Kartalar sayasi</small>
                                </div>
                                <div class="card component-preview-card" style="padding: 20px; margin-top: 15px;">
                                    <h4>Test karta</h4>
                                    <p>O'zgarishlar real vaqtda ko'rinadi.</p>
                                </div>
                            </div>

                            <!-- Input Maydonlari -->
                            <div class="component-section">
                                <h4>‚úçÔ∏è Input maydonlari</h4>
                                <div class="form-group">
                                    <label for="input-radius">‚ÜóÔ∏è Burchak o'lchami</label>
                                    <input type="range" id="input-radius" class="range-input" min="0" max="20" value="6" step="2">
                                    <span class="range-value" id="input-radius-value">6px</span>
                                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Input burchaklari</small>
                                </div>
                                <div class="form-group">
                                    <input type="text" class="form-control component-preview-input" placeholder="Test maydoni" style="margin-top: 10px;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 6Ô∏è‚É£ SPACING -->
                    <div class="branding-tab-content" data-content="spacing">
                        <h3 class="section-title">üìê Masofa va Bo'shliqlar</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">üéØ Bu yerda o'zgartirishlar: <strong>Elementlar oralig'i, ichki bo'shliqlar</strong></p>
                        
                        <!-- Impact indicator -->
                        <div style="background: rgba(0, 123, 255, 0.1); border: 1px solid rgba(0, 123, 255, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 25px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 14px; color: #007bff;">üìç Qayerda o'zgaradi?</h4>
                            <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.8;">
                                <div>‚Ä¢ Sahifa elementlari oralig'i</div>
                                <div>‚Ä¢ Kartalar ichki bo'shliqlari</div>
                                <div>‚Ä¢ Bo'limlar orasidagi masofalar</div>
                            </div>
                        </div>
                        
                        <div class="spacing-grid">
                            <div class="form-group">
                                <label for="spacing-unit">üìè Asosiy birlik</label>
                                <input type="range" id="spacing-unit" class="range-input" min="4" max="16" value="8" step="2">
                                <span class="range-value" id="spacing-unit-value">8px</span>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Barcha masofalar asosi</small>
                            </div>

                            <div class="form-group">
                                <label for="container-padding">üì¶ Ichki bo'shliq</label>
                                <input type="range" id="container-padding" class="range-input" min="10" max="50" value="30" step="5">
                                <span class="range-value" id="container-padding-value">30px</span>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Sahifa chetlari</small>
                            </div>

                            <div class="form-group">
                                <label for="section-gap">‚ÜîÔ∏è Bo'limlar oralig'i</label>
                                <input type="range" id="section-gap" class="range-input" min="10" max="60" value="30" step="5">
                                <span class="range-value" id="section-gap-value">30px</span>
                                <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Kartalar orasidagi masofa</small>
                            </div>
                        </div>
                    </div>

                    <!-- 7Ô∏è‚É£ LOADER -->
                    <div class="branding-tab-content" data-content="loader">
                        <h3 class="section-title">üîÑ Yuklanish Animatsiyasi</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">üéØ Bu yerda o'zgartirishlar: <strong>Sahifa yuklanayotganda ko'rinish</strong></p>
                        
                        <!-- Impact indicator -->
                        <div style="background: rgba(0, 123, 255, 0.1); border: 1px solid rgba(0, 123, 255, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 25px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 14px; color: #007bff;">üìç Qayerda o'zgaradi?</h4>
                            <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.8;">
                                <div>‚Ä¢ Sahifa yuklanyapganda</div>
                                <div>‚Ä¢ Ma'lumotlar yuklanayotganda</div>
                                <div>‚Ä¢ Pivot jadval yangilanayotganda</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="loader-type">üé® Loader turi</label>
                            <select id="loader-type" class="form-control">
                                <option value="spinner">üîÑ Spinning Circle - Oddiy aylana</option>
                                <option value="dots">‚ö´ Dots - Nuqtalar</option>
                                <option value="pulse">üíì Pulse Ring - Pulsatsiya</option>
                                <option value="gradient">üåà Gradient Spinner - Rangli aylana</option>
                                <option value="bars">üìä Bars - Ustunlar</option>
                                <option value="progress">üìà Circle Progress - Doira progress</option>
                                <option value="bounce">üèÄ Bouncing Balls - Sakrash</option>
                                <option value="cube">üé≤ Cube Flip - Kub aylanishi</option>
                                <option value="dna">üß¨ DNA Helix - DNA spiral</option>
                                <option value="hexagon">‚¨° Hexagon - Olti burchak</option>
                            </select>
                            <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Yuklanish animatsiyasi uslubi</small>
                        </div>

                        <div class="form-group">
                            <label for="loader-text-input">üìù Yuklanish matni</label>
                            <input type="text" id="loader-text-input" class="form-control" placeholder="Yuklanmoqda..." value="Yuklanmoqda...">
                            <small style="display: block; margin-top: 5px; color: var(--text-secondary);">Loader ostida ko'rinuvchi matn</small>
                        </div>

                        <div class="form-group">
                            <label>üé≠ Qo'shimcha effektlar</label>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="loader-show-progress" checked>
                                    <span>Progress bar ko'rsatish</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="loader-blur-background" checked>
                                    <span>Fon blur effekti</span>
                                </label>
                            </div>
                        </div>

                        <div style="margin-top: 30px;">
                            <h4 style="margin: 20px 0 15px 0; font-size: 14px; color: #007bff;">üëÅÔ∏è Ko'rib chiqish</h4>
                            <div id="loader-preview-container" style="position: relative; height: 200px; background: rgba(26, 28, 35, 0.5); border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                <div id="loader-preview-animation" class="loader-spinner"></div>
                                <div class="loader-text" id="loader-preview-text">Yuklanmoqda...</div>
                                <div class="loader-progress-bar" id="loader-preview-progress" style="display: block;"></div>
                            </div>
                            <button id="test-loader-btn" class="btn btn-primary" style="margin-top: 15px; width: 100%;">
                                <i data-feather="play"></i> Test qilish (3 soniya)
                            </button>
                        </div>
                    </div>

                </div>

                <!-- SAQLASH TUGMASI -->
                <div class="page-footer" style="margin-top: 30px;">
                    <button id="save-branding-settings-btn" class="btn btn-primary btn-lg">
                        <i data-feather="save"></i> üíæ Saqlash
                    </button>
                    <p style="margin-top: 10px; color: var(--text-secondary); font-size: 13px;">Barcha o'zgarishlar tizimda saqlanadi va darhol qo'llaniladi</p>
                </div>
            </section>

            <!-- Sozlamalar -->
            <section id="settings" class="page" data-permission="settings:view">
                <div class="page-header">
                    <div>
                        <h1 class="page-title">‚öôÔ∏è Sozlamalar</h1>
                        <p class="page-description">
                            Tizim parametrlarini boshqaring: jadval ustunlari, brendlar, Telegram va umumiy sozlamalar
                        </p>
                    </div>
                </div>
                <div class="settings-layout">
                    <div class="card settings-card" data-permission="settings:edit_table">
                        <div class="settings-card-header">
                            <div class="settings-card-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <i data-feather="table"></i>
                            </div>
                            <div>
                                <h3 class="card-title">üìä Jadval Sozlamalari</h3>
                                <p class="card-subtitle">Ustunlar, brendlar va filiallarni boshqarish</p>
                            </div>
                        </div>
                        <div class="accordion-container">
                            <div class="accordion-item">
                                <div class="accordion-header"><h3 class="card-title">Ustunlar</h3><i data-feather="chevron-down" class="accordion-icon"></i></div>
                                <div class="accordion-content">
                                    <div class="settings-list" id="columns-settings"></div>
                                    <button class="btn btn-primary" id="add-column-btn" style="width: 100%; margin-top: 10px;"><i data-feather="plus"></i> Yangi Ustun Qo'shish</button>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <div class="accordion-header"><h3 class="card-title">Brendlar</h3><i data-feather="chevron-down" class="accordion-icon"></i></div>
                                <div class="accordion-content">
                                    <div class="settings-list" id="brands-settings"></div>
                                    <button class="btn btn-primary" id="add-brand-btn" style="width: 100%; margin-top: 10px;"><i data-feather="plus"></i> Yangi Brend Qo'shish</button>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <div class="accordion-header"><h3 class="card-title">Filiallar</h3><i data-feather="chevron-down" class="accordion-icon"></i></div>
                                <div class="accordion-content">
                                    <div class="settings-list" id="locations-settings"></div>
                                    <button class="btn btn-primary" id="add-location-btn" style="width: 100%; margin-top: 10px;"><i data-feather="plus"></i> Yangi Filial Qo'shish</button>
                                </div>
                            </div>
                        </div>
                        <div class="page-footer">
                            <button class="btn btn-primary" id="save-table-settings-btn" data-permission="settings:edit_table"><i data-feather="save"></i> Jadval Sozlamalarini Saqlash</button>
                        </div>
                    </div>
                    <div class="other-settings">
                        <div class="card settings-card" data-permission="settings:edit_telegram">
                            <div class="settings-card-header">
                                <div class="settings-card-icon" style="background: linear-gradient(135deg, #0088cc 0%, #0077b6 100%);">
                                    <i data-feather="send"></i>
                                </div>
                                <div>
                                    <h3 class="card-title">üì± Telegram Bot</h3>
                                    <p class="card-subtitle">Bot sozlamalari va ulanish ma'lumotlari</p>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="bot-token">Bot Token</label>
                                <div class="secure-input-wrapper">
                                    <input type="password" id="bot-token" class="form-control" placeholder="Token yashirilgan" autocomplete="off">
                                    <button type="button" class="btn-icon toggle-visibility-btn" title="Ko'rsatish/Yashirish" aria-label="Ko'rsatish/Yashirish">üëÅ</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="group-id">Guruh ID</label>
                                <div class="secure-input-wrapper">
                                    <input type="password" id="group-id" class="form-control" placeholder="ID yashirilgan" autocomplete="off">
                                    <button type="button" class="btn-icon toggle-visibility-btn" title="Ko'rsatish/Yashirish" aria-label="Ko'rsatish/Yashirish">üëÅ</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="admin-chat-id">Adminning Telegram Chat ID'si</label>
                                <div class="secure-input-wrapper">
                                    <input type="password" id="admin-chat-id" class="form-control" placeholder="ID yashirilgan" autocomplete="off">
                                    <button type="button" class="btn-icon toggle-visibility-btn" title="Ko'rsatish/Yashirish" aria-label="Ko'rsatish/Yashirish">üëÅ</button>
                                </div>
                            </div>
                             <div class="form-group">
                                <label for="bot-username">Bot Username (@ belgisisiz)</label>
                                <input type="text" id="bot-username" class="form-control" placeholder="Botingizning username'i">
                            </div>
                            <button class="btn btn-primary" id="save-telegram-btn"><i data-feather="save"></i> Saqlash</button>
                        </div>
                        <div class="card settings-card" data-permission="settings:edit_general">
                            <div class="settings-card-header">
                                <div class="settings-card-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                    <i data-feather="sliders"></i>
                                </div>
                                <div>
                                    <h3 class="card-title">üîß Umumiy</h3>
                                    <p class="card-subtitle">Tizim parametrlari va konfiguratsiya</p>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="pagination-limit">Sahifadagi hisobotlar soni</label>
                                <input type="number" id="pagination-limit" class="form-control" min="5" max="100" placeholder="20">
                            </div>
                            <button class="btn btn-primary" id="save-general-settings-btn"><i data-feather="save"></i> Saqlash</button>
                        </div>
                        
                        <!-- KPI Sozlamalari -->
                        <div class="card settings-card" data-permission="settings:edit_general">
                            <div class="settings-card-header">
                                <div class="settings-card-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                    <i data-feather="trending-up"></i>
                                </div>
                                <div>
                                    <h3 class="card-title">üìà KPI Sozlamalari</h3>
                                    <p class="card-subtitle">Jarima koeffitsientlari va hisoblash parametrlari</p>
                                </div>
                            </div>
                            <p class="page-description" style="font-size: 14px; margin-bottom: 15px; margin-top: 15px;">
                                KPI ballini hisoblash uchun jarima koeffitsientlarini belgilang (0 dan 1 gacha).
                            </p>
                            <div class="form-group">
                                <label for="late-penalty-input">Kechikkan hisobot uchun jarima</label>
                                <input type="number" id="late-penalty-input" class="form-control" min="0" max="1" step="0.1" placeholder="Masalan, 0.5">
                                <small>Har bir kechikkan hisobot foizi shu songa ko'paytiriladi va umumiy balldan ayiriladi.</small>
                            </div>
                            <div class="form-group">
                                <label for="edit-penalty-input">Tahrirlangan hisobot uchun jarima</label>
                                <input type="number" id="edit-penalty-input" class="form-control" min="0" max="1" step="0.1" placeholder="Masalan, 0.3">
                                <small>Har bir tahrirlangan hisobot foizi shu songa ko'paytiriladi va umumiy balldan ayiriladi.</small>
                            </div>
                            <button class="btn btn-primary" id="save-kpi-settings-btn"><i data-feather="save"></i> KPI Sozlamalarini Saqlash</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODAL OYNALAR -->
    <div id="user-form-modal" class="modal hidden">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="user-modal-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                        </svg>
                        <span>Foydalanuvchi</span>
                    </h3>
                    <button class="btn-close close-modal-btn" data-target="user-form-modal"></button>
                </div>
                <div class="modal-body">
                    <form id="user-form">
                <input type="hidden" id="edit-user-id">
                <div class="form-group">
                    <label for="user-username">Login (username)</label>
                    <input type="text" id="user-username" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="user-fullname">To'liq ism (F.I.Sh)</label>
                    <input type="text" id="user-fullname" class="form-control">
                </div>
                <div class="form-group" id="password-group">
                    <label for="user-password">Yangi Parol</label>
                    <div class="secure-input-wrapper">
                        <input type="password" id="user-password" class="form-control" minlength="8" autocomplete="new-password">
                        <button type="button" class="btn-icon toggle-visibility-btn" title="Ko'rsatish/Yashirish"><i data-feather="eye"></i></button>
                    </div>
                    <small>Yangi foydalanuvchi uchun majburiy. Tahrirlashda bo'sh qoldiring.</small>
                </div>
                <div class="form-group">
                    <label for="user-role">Rol</label>
                    <select id="user-role" class="form-control"></select>
                </div>
                <div class="form-group">
                    <label for="user-device-limit">Ruxsat etilgan qurilmalar soni</label>
                    <input type="number" id="user-device-limit" class="form-control" value="1" min="1">
                </div>
                <div class="form-group" id="user-locations-group">
                    <label>Biriktirilgan filiallar:</label>
                    <div class="checkbox-grid" id="locations-checkbox-list"></div>
                </div>
                <div class="form-group" id="user-brands-group" style="display: none;">
                    <label>Biriktirilgan brendlar (Menejerlar uchun):</label>
                    <p style="color: rgba(255,255,255,0.6); font-size: 13px; margin-bottom: 10px;">
                        Menejer faqat o'ziga biriktirilgan brendlar ma'lumotlarini ko'radi
                    </p>
                    <div id="user-brands-list" style="max-height: 200px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 10px; background: rgba(0,0,0,0.2);">
                        <!-- Brendlar checkbox ro'yxati -->
                    </div>
                </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary close-modal-btn" data-target="user-form-modal">Bekor qilish</button>
                    <button type="submit" form="user-form" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        Saqlash
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="approval-modal" class="modal hidden">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        Foydalanuvchi So'rovini Tasdiqlash
                    </h3>
                    <button class="btn-close close-modal-btn" data-target="approval-modal"></button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 20px;">Foydalanuvchi <strong id="approval-username"></strong> uchun rol va filiallarni belgilang.</p>
                    <form id="approval-form">
                        <input type="hidden" id="approval-user-id">
                        <div class="form-group">
                            <label for="approval-role">Rol</label>
                            <select id="approval-role" class="form-control" required></select>
                        </div>
                        <div class="form-group" id="approval-locations-group" style="display: none;">
                            <label>Biriktirilgan filiallar:</label>
                            <div class="checkbox-grid" id="approval-locations-checkbox-list"></div>
                        </div>
                        <div class="form-group" id="approval-brands-group" style="display: none;">
                            <label>Biriktirilgan brendlar <span style="color: var(--red-color);">*</span></label>
                            <p style="color: rgba(255,255,255,0.6); font-size: 13px; margin-bottom: 10px;">
                                Manager uchun kamida bitta brend tanlanishi shart
                            </p>
                            <div id="approval-brands-list" style="max-height: 200px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 10px; background: rgba(0,0,0,0.2);">
                                <!-- JS orqali to'ldiriladi -->
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary close-modal-btn" data-target="approval-modal">Bekor qilish</button>
                    <button type="submit" form="approval-form" class="btn btn-success">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        Tasdiqlash va Aktivlashtirish
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="credentials-modal" class="modal hidden">
        <div class="modal-dialog modal-dialog-centered modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="credentials-modal-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                        </svg>
                        <span>Ma'lumotlar</span>
                    </h3>
                    <button class="btn-close close-modal-btn" data-target="credentials-modal"></button>
                </div>
                <div class="modal-body">
                    <form id="credentials-form">
                        <input type="hidden" id="credentials-user-id">
                        <div class="form-group">
                            <label for="credentials-input" id="credentials-input-label"></label>
                            <div class="secure-input-wrapper">
                                <input type="password" id="credentials-input" class="form-control" required minlength="6" autocomplete="new-password">
                                <button type="button" class="btn-icon toggle-visibility-btn" title="Ko'rsatish/Yashirish"><i data-feather="eye"></i></button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary close-modal-btn" data-target="credentials-modal">Bekor qilish</button>
                    <button type="submit" form="credentials-form" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        Saqlash
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="telegram-connect-modal" class="modal hidden">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154 0 0 1-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426 0 0 0-.013-.315.337.337 0 0 0-.114-.217.526.526 0 0 0-.31-.093c-.3.005-.763.166-2.984 1.09z"/>
                        </svg>
                        Telegram Botga Ulash
                    </h3>
                    <button class="btn-close close-modal-btn" data-target="telegram-connect-modal"></button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 20px; color: var(--text-secondary);">
                        Quyidagi bir martalik havolani nusxalab, foydalanuvchiga yuboring. Foydalanuvchi bu havolani bosib, botda "/start" buyrug'ini yuborishi kerak.
                    </p>
                    <div class="form-group secure-input-wrapper">
                        <input type="text" id="telegram-connect-link" class="form-control" readonly>
                        <button type="button" id="copy-telegram-link-btn" class="btn-icon" title="Nusxalash"><i data-feather="copy"></i></button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary close-modal-btn" data-target="telegram-connect-modal">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                        </svg>
                        OK
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="sessions-modal" class="modal hidden">
        <div class="modal-content">
            <button class="close-modal-btn" data-target="sessions-modal"><i data-feather="x"></i></button>
            <h3 class="modal-title" id="sessions-modal-title"></h3>
            <div id="sessions-list-container" class="sessions-list"></div>
        </div>
    </div>
    

    <div id="audit-details-modal" class="modal hidden">
        <div class="modal-content">
            <button class="close-modal-btn" data-target="audit-details-modal"><i data-feather="x"></i></button>
            <h3 class="modal-title">Amal Tafsilotlari</h3>
            <div id="audit-details-body" class="modal-body"></div>
        </div>
    </div>

    <div id="report-detail-modal" class="modal hidden">
        <div class="modal-content report-detail-modal-content">
            <button class="close-modal-btn" data-target="report-detail-modal"><i data-feather="x"></i></button>
            <div id="report-detail-body" class="report-detail-body">
                <div class="report-detail-loader">
                    <div class="spinner"></div>
                    <p>Yuklanmoqda...</p>
                </div>
            </div>
        </div>
    </div>

    <div id="toast-notification" class="toast hidden"></div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.webdatarocks.com/latest/webdatarocks.toolbar.min.js"></script>
    <script src="https://cdn.webdatarocks.com/latest/webdatarocks.js"></script>
    <script src="https://cdn.webdatarocks.com/loc/webdatarocks.locale.ru.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/uz.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script type="module" src="admin.js"></script>
</body>
</html>

